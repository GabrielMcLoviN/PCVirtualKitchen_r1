/*! For license information please see index.bundle.js.LICENSE.txt */
!function(){var t={2060:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return m}});const r={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},i={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},o={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},s={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},a={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class u{static getFirstMatch(t,e){const n=e.match(t);return n&&n.length>0&&n[1]||""}static getSecondMatch(t,e){const n=e.match(t);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(t,e,n){if(t.test(e))return n}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const e=t.split(".").splice(0,2).map((t=>parseInt(t,10)||0));if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const e=t.split(".").splice(0,2).map((t=>parseInt(t,10)||0));if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,e,n=!1){const r=u.getVersionPrecision(t),i=u.getVersionPrecision(e);let o=Math.max(r,i),s=0;const a=u.map([t,e],(t=>{const e=o-u.getVersionPrecision(t),n=t+new Array(e+1).join(".0");return u.map(n.split("."),(t=>new Array(20-t.length).join("0")+t)).reverse()}));for(n&&(s=o-Math.min(r,i)),o-=1;o>=s;){if(a[0][o]>a[1][o])return 1;if(a[0][o]===a[1][o]){if(o===s)return 0;o-=1}else if(a[0][o]<a[1][o])return-1}}static map(t,e){const n=[];let r;if(Array.prototype.map)return Array.prototype.map.call(t,e);for(r=0;r<t.length;r+=1)n.push(e(t[r]));return n}static find(t,e){let n,r;if(Array.prototype.find)return Array.prototype.find.call(t,e);for(n=0,r=t.length;n<r;n+=1){const r=t[n];if(e(r,n))return r}}static assign(t,...e){const n=t;let r,i;if(Object.assign)return Object.assign(t,...e);for(r=0,i=e.length;r<i;r+=1){const t=e[r];"object"==typeof t&&null!==t&&Object.keys(t).forEach((e=>{n[e]=t[e]}))}return t}static getBrowserAlias(t){return r[t]}static getBrowserTypeByAlias(t){return i[t]||""}}const h=/version\/(\d+(\.?_?\d+)+)/i;var c=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=u.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=u.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=u.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=u.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=u.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=u.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=u.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=u.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=u.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=u.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=u.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=u.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=u.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=u.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=u.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=u.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=u.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=u.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=u.getFirstMatch(h,t)||u.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=u.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=u.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=u.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=u.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=u.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=u.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=u.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=u.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=u.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=u.getFirstMatch(h,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:u.getFirstMatch(e,t),version:u.getSecondMatch(e,t)}}}],l=[{test:[/Roku\/DVP/],describe(t){const e=u.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:s.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=u.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:s.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=u.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=u.getWindowsVersionName(e);return{name:s.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:s.iOS},n=u.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=u.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=u.getMacOSVersionName(e),r={name:s.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=u.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:s.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=u.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=u.getAndroidVersionName(e),r={name:s.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=u.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:s.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=u.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||u.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||u.getFirstMatch(/\bbb(\d+)/i,t);return{name:s.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=u.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:s.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=u.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:s.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:s.Linux})},{test:[/CrOS/],describe:()=>({name:s.ChromeOS})},{test:[/PlayStation 4/],describe(t){const e=u.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:s.PlayStation4,version:e}}}],p=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(t){const e=u.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:o.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:o.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:o.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:o.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:o.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:o.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:o.tablet})},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=u.getFirstMatch(/(ipod|iphone)/i,t);return{type:o.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:o.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:o.mobile})},{test:t=>"blackberry"===t.getBrowserName(!0),describe:()=>({type:o.mobile,vendor:"BlackBerry"})},{test:t=>"bada"===t.getBrowserName(!0),describe:()=>({type:o.mobile})},{test:t=>"windows phone"===t.getBrowserName(),describe:()=>({type:o.mobile,vendor:"Microsoft"})},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&e>=3},describe:()=>({type:o.tablet})},{test:t=>"android"===t.getOSName(!0),describe:()=>({type:o.mobile})},{test:t=>"macos"===t.getOSName(!0),describe:()=>({type:o.desktop,vendor:"Apple"})},{test:t=>"windows"===t.getOSName(!0),describe:()=>({type:o.desktop})},{test:t=>"linux"===t.getOSName(!0),describe:()=>({type:o.desktop})},{test:t=>"playstation 4"===t.getOSName(!0),describe:()=>({type:o.tv})},{test:t=>"roku"===t.getOSName(!0),describe:()=>({type:o.tv})}],f=[{test:t=>"microsoft edge"===t.getBrowserName(!0),describe(t){if(/\sedg\//i.test(t))return{name:a.Blink};const e=u.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:a.EdgeHTML,version:e}}},{test:[/trident/i],describe(t){const e={name:a.Trident},n=u.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:t=>t.test(/presto/i),describe(t){const e={name:a.Presto},n=u.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:a.Gecko},n=u.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:a.Blink})},{test:[/(apple)?webkit/i],describe(t){const e={name:a.WebKit},n=u.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}],d=class{constructor(t,e=!1){if(null==t||""===t)throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==e&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=u.find(c,(t=>{if("function"==typeof t.test)return t.test(this);if(t.test instanceof Array)return t.test.some((t=>this.test(t)));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=u.find(l,(t=>{if("function"==typeof t.test)return t.test(this);if(t.test instanceof Array)return t.test.some((t=>this.test(t)));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:e}=this.getOS();return t?String(e).toLowerCase()||"":e||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:e}=this.getPlatform();return t?String(e).toLowerCase()||"":e||""}parsePlatform(){this.parsedResult.platform={};const t=u.find(p,(t=>{if("function"==typeof t.test)return t.test(this);if(t.test instanceof Array)return t.test.some((t=>this.test(t)));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=u.find(f,(t=>{if("function"==typeof t.test)return t.test(this);if(t.test instanceof Array)return t.test.some((t=>this.test(t)));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return u.assign({},this.parsedResult)}satisfies(t){const e={};let n=0;const r={};let i=0;if(Object.keys(t).forEach((o=>{const s=t[o];"string"==typeof s?(r[o]=s,i+=1):"object"==typeof s&&(e[o]=s,n+=1)})),n>0){const t=Object.keys(e),n=u.find(t,(t=>this.isOS(t)));if(n){const t=this.satisfies(e[n]);if(void 0!==t)return t}const r=u.find(t,(t=>this.isPlatform(t)));if(r){const t=this.satisfies(e[r]);if(void 0!==t)return t}}if(i>0){const t=Object.keys(r),e=u.find(t,(t=>this.isBrowser(t,!0)));if(void 0!==e)return this.compareVersion(r[e])}}isBrowser(t,e=!1){const n=this.getBrowserName().toLowerCase();let r=t.toLowerCase();const i=u.getBrowserTypeByAlias(r);return e&&i&&(r=i.toLowerCase()),r===n}compareVersion(t){let e=[0],n=t,r=!1;const i=this.getBrowserVersion();if("string"==typeof i)return">"===t[0]||"<"===t[0]?(n=t.substr(1),"="===t[1]?(r=!0,n=t.substr(2)):e=[],">"===t[0]?e.push(1):e.push(-1)):"="===t[0]?n=t.substr(1):"~"===t[0]&&(r=!0,n=t.substr(1)),e.indexOf(u.compareVersions(i,n,r))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t,e=!1){return this.isBrowser(t,e)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some((t=>this.is(t)))}},m=class{static getParser(t,e=!1){if("string"!=typeof t)throw new Error("UserAgent should be a string");return new d(t,e)}static parse(t){return new d(t).getResult()}static get BROWSER_MAP(){return i}static get ENGINE_MAP(){return a}static get OS_MAP(){return s}static get PLATFORMS_MAP(){return o}}},887:function(t,e,n){"use strict";n.r(e),n.d(e,{glMatrix:function(){return r},mat2:function(){return i},mat2d:function(){return o},mat3:function(){return s},mat4:function(){return a},quat:function(){return c},quat2:function(){return l},vec2:function(){return p},vec3:function(){return u},vec4:function(){return h}});var r={};n.r(r),n.d(r,{ARRAY_TYPE:function(){return d},EPSILON:function(){return f},RANDOM:function(){return m},equals:function(){return g},setMatrixArrayType:function(){return v},toRadian:function(){return y}});var i={};n.r(i),n.d(i,{LDU:function(){return O},add:function(){return D},adjoint:function(){return S},clone:function(){return M},copy:function(){return b},create:function(){return w},determinant:function(){return P},equals:function(){return V},exactEquals:function(){return q},frob:function(){return H},fromRotation:function(){return F},fromScaling:function(){return k},fromValues:function(){return E},identity:function(){return x},invert:function(){return C},mul:function(){return j},multiply:function(){return A},multiplyScalar:function(){return N},multiplyScalarAndAdd:function(){return X},rotate:function(){return R},scale:function(){return z},set:function(){return T},str:function(){return I},sub:function(){return Y},subtract:function(){return B},transpose:function(){return L}});var o={};n.r(o),n.d(o,{add:function(){return ht},clone:function(){return U},copy:function(){return G},create:function(){return W},determinant:function(){return $},equals:function(){return dt},exactEquals:function(){return ft},frob:function(){return ut},fromRotation:function(){return it},fromScaling:function(){return ot},fromTranslation:function(){return st},fromValues:function(){return Z},identity:function(){return K},invert:function(){return J},mul:function(){return mt},multiply:function(){return tt},multiplyScalar:function(){return lt},multiplyScalarAndAdd:function(){return pt},rotate:function(){return et},scale:function(){return nt},set:function(){return Q},str:function(){return at},sub:function(){return vt},subtract:function(){return ct},translate:function(){return rt}});var s={};n.r(s),n.d(s,{add:function(){return Vt},adjoint:function(){return Lt},clone:function(){return gt},copy:function(){return wt},create:function(){return _t},determinant:function(){return Ct},equals:function(){return Wt},exactEquals:function(){return Yt},frob:function(){return qt},fromMat2d:function(){return It},fromMat4:function(){return yt},fromQuat:function(){return Ht},fromRotation:function(){return Ft},fromScaling:function(){return kt},fromTranslation:function(){return zt},fromValues:function(){return Mt},identity:function(){return xt},invert:function(){return Tt},mul:function(){return Ut},multiply:function(){return St},multiplyScalar:function(){return Xt},multiplyScalarAndAdd:function(){return jt},normalFromMat4:function(){return Ot},projection:function(){return Dt},rotate:function(){return At},scale:function(){return Rt},set:function(){return bt},str:function(){return Bt},sub:function(){return Gt},subtract:function(){return Nt},translate:function(){return Pt},transpose:function(){return Et}});var a={};n.r(a),n.d(a,{add:function(){return ke},adjoint:function(){return re},clone:function(){return Zt},copy:function(){return Qt},create:function(){return Kt},determinant:function(){return ie},equals:function(){return Be},exactEquals:function(){return De},frob:function(){return Fe},fromQuat:function(){return Te},fromQuat2:function(){return ge},fromRotation:function(){return de},fromRotationTranslation:function(){return ye},fromRotationTranslationScale:function(){return xe},fromRotationTranslationScaleOrigin:function(){return Ee},fromScaling:function(){return fe},fromTranslation:function(){return pe},fromValues:function(){return Jt},fromXRotation:function(){return me},fromYRotation:function(){return ve},fromZRotation:function(){return _e},frustum:function(){return Le},getRotation:function(){return be},getScaling:function(){return Me},getTranslation:function(){return we},identity:function(){return te},invert:function(){return ne},lookAt:function(){return Ae},mul:function(){return qe},multiply:function(){return oe},multiplyScalar:function(){return He},multiplyScalarAndAdd:function(){return Oe},ortho:function(){return Pe},perspective:function(){return Ce},perspectiveFromFieldOfView:function(){return Se},rotate:function(){return ue},rotateX:function(){return he},rotateY:function(){return ce},rotateZ:function(){return le},scale:function(){return ae},set:function(){return $t},str:function(){return ze},sub:function(){return Ve},subtract:function(){return Ie},targetTo:function(){return Re},translate:function(){return se},transpose:function(){return ee}});var u={};n.r(u),n.d(u,{add:function(){return Ge},angle:function(){return En},bezier:function(){return vn},ceil:function(){return Je},clone:function(){return Xe},copy:function(){return We},create:function(){return Ne},cross:function(){return fn},dist:function(){return Fn},distance:function(){return sn},div:function(){return zn},divide:function(){return Qe},dot:function(){return pn},equals:function(){return Sn},exactEquals:function(){return Cn},floor:function(){return $e},forEach:function(){return On},fromValues:function(){return Ye},hermite:function(){return mn},inverse:function(){return cn},len:function(){return In},length:function(){return je},lerp:function(){return dn},max:function(){return en},min:function(){return tn},mul:function(){return Rn},multiply:function(){return Ze},negate:function(){return hn},normalize:function(){return ln},random:function(){return _n},rotateX:function(){return Mn},rotateY:function(){return bn},rotateZ:function(){return xn},round:function(){return nn},scale:function(){return rn},scaleAndAdd:function(){return on},set:function(){return Ue},sqrDist:function(){return kn},sqrLen:function(){return Hn},squaredDistance:function(){return an},squaredLength:function(){return un},str:function(){return Ln},sub:function(){return An},subtract:function(){return Ke},transformMat3:function(){return gn},transformMat4:function(){return yn},transformQuat:function(){return wn},zero:function(){return Tn}});var h={};n.r(h),n.d(h,{add:function(){return Xn},ceil:function(){return Un},clone:function(){return Bn},copy:function(){return Vn},create:function(){return Dn},cross:function(){return ur},dist:function(){return wr},distance:function(){return tr},div:function(){return gr},divide:function(){return Wn},dot:function(){return ar},equals:function(){return vr},exactEquals:function(){return mr},floor:function(){return Gn},forEach:function(){return Er},fromValues:function(){return qn},inverse:function(){return or},len:function(){return br},length:function(){return nr},lerp:function(){return hr},max:function(){return Zn},min:function(){return Kn},mul:function(){return yr},multiply:function(){return Yn},negate:function(){return ir},normalize:function(){return sr},random:function(){return cr},round:function(){return Qn},scale:function(){return Jn},scaleAndAdd:function(){return $n},set:function(){return Nn},sqrDist:function(){return Mr},sqrLen:function(){return xr},squaredDistance:function(){return er},squaredLength:function(){return rr},str:function(){return dr},sub:function(){return _r},subtract:function(){return jn},transformMat4:function(){return lr},transformQuat:function(){return pr},zero:function(){return fr}});var c={};n.r(c),n.d(c,{add:function(){return ei},calculateW:function(){return kr},clone:function(){return Qr},conjugate:function(){return Vr},copy:function(){return $r},create:function(){return Tr},dot:function(){return ii},equals:function(){return pi},exactEquals:function(){return li},exp:function(){return Ir},fromEuler:function(){return Xr},fromMat3:function(){return Nr},fromValues:function(){return Jr},getAngle:function(){return Pr},getAxisAngle:function(){return Sr},identity:function(){return Lr},invert:function(){return qr},len:function(){return ai},length:function(){return si},lerp:function(){return oi},ln:function(){return Hr},mul:function(){return ni},multiply:function(){return Ar},normalize:function(){return ci},pow:function(){return Or},random:function(){return Br},rotateX:function(){return Rr},rotateY:function(){return zr},rotateZ:function(){return Fr},rotationTo:function(){return fi},scale:function(){return ri},set:function(){return ti},setAxes:function(){return mi},setAxisAngle:function(){return Cr},slerp:function(){return Dr},sqlerp:function(){return di},sqrLen:function(){return hi},squaredLength:function(){return ui},str:function(){return jr}});var l={};n.r(l),n.d(l,{add:function(){return Bi},clone:function(){return _i},conjugate:function(){return Wi},copy:function(){return Ei},create:function(){return vi},dot:function(){return Xi},equals:function(){return to},exactEquals:function(){return $i},fromMat4:function(){return xi},fromRotation:function(){return bi},fromRotationTranslation:function(){return wi},fromRotationTranslationValues:function(){return gi},fromTranslation:function(){return Mi},fromValues:function(){return yi},getDual:function(){return Si},getReal:function(){return Ci},getTranslation:function(){return Ri},identity:function(){return Ti},invert:function(){return Yi},len:function(){return Gi},length:function(){return Ui},lerp:function(){return ji},mul:function(){return Vi},multiply:function(){return qi},normalize:function(){return Qi},rotateAroundAxis:function(){return Di},rotateByQuatAppend:function(){return Hi},rotateByQuatPrepend:function(){return Oi},rotateX:function(){return Fi},rotateY:function(){return ki},rotateZ:function(){return Ii},scale:function(){return Ni},set:function(){return Li},setDual:function(){return Ai},setReal:function(){return Pi},sqrLen:function(){return Zi},squaredLength:function(){return Ki},str:function(){return Ji},translate:function(){return zi}});var p={};n.r(p),n.d(p,{add:function(){return so},angle:function(){return ko},ceil:function(){return co},clone:function(){return no},copy:function(){return io},create:function(){return eo},cross:function(){return Lo},dist:function(){return Xo},distance:function(){return yo},div:function(){return No},divide:function(){return ho},dot:function(){return To},equals:function(){return Do},exactEquals:function(){return Oo},floor:function(){return lo},forEach:function(){return Wo},fromValues:function(){return ro},inverse:function(){return xo},len:function(){return Bo},length:function(){return wo},lerp:function(){return Co},max:function(){return fo},min:function(){return po},mul:function(){return Vo},multiply:function(){return uo},negate:function(){return bo},normalize:function(){return Eo},random:function(){return So},rotate:function(){return Fo},round:function(){return mo},scale:function(){return vo},scaleAndAdd:function(){return _o},set:function(){return oo},sqrDist:function(){return jo},sqrLen:function(){return Yo},squaredDistance:function(){return go},squaredLength:function(){return Mo},str:function(){return Ho},sub:function(){return qo},subtract:function(){return ao},transformMat2:function(){return Po},transformMat2d:function(){return Ao},transformMat3:function(){return Ro},transformMat4:function(){return zo},zero:function(){return Io}});var f=1e-6,d="undefined"!=typeof Float32Array?Float32Array:Array,m=Math.random;function v(t){d=t}var _=Math.PI/180;function y(t){return t*_}function g(t,e){return Math.abs(t-e)<=f*Math.max(1,Math.abs(t),Math.abs(e))}function w(){var t=new d(4);return d!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function M(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function b(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function E(t,e,n,r){var i=new d(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function T(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function L(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function C(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*o-i*r;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=n*s,t):null}function S(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function P(t){return t[0]*t[3]-t[2]*t[1]}function A(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],h=n[2],c=n[3];return t[0]=r*a+o*u,t[1]=i*a+s*u,t[2]=r*h+o*c,t[3]=i*h+s*c,t}function R(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*a,t[1]=i*u+s*a,t[2]=r*-a+o*u,t[3]=i*-a+s*u,t}function z(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1];return t[0]=r*a,t[1]=i*a,t[2]=o*u,t[3]=s*u,t}function F(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function k(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function I(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function H(t){return Math.hypot(t[0],t[1],t[2],t[3])}function O(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function D(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function B(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function q(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function V(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],u=e[2],h=e[3];return Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=f*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=f*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=f*Math.max(1,Math.abs(o),Math.abs(h))}function N(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function X(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var j=A,Y=B;function W(){var t=new d(6);return d!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function U(t){var e=new d(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function G(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function K(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Z(t,e,n,r,i,o){var s=new d(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s[4]=i,s[5]=o,s}function Q(t,e,n,r,i,o,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t}function J(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*a-o*s)*u,t[5]=(r*s-n*a)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=n[0],c=n[1],l=n[2],p=n[3],f=n[4],d=n[5];return t[0]=r*h+o*c,t[1]=i*h+s*c,t[2]=r*l+o*p,t[3]=i*l+s*p,t[4]=r*f+o*d+a,t[5]=i*f+s*d+u,t}function et(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*h,t[1]=i*c+s*h,t[2]=r*-h+o*c,t[3]=i*-h+s*c,t[4]=a,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=n[0],c=n[1];return t[0]=r*h,t[1]=i*h,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=n[0],c=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=r*h+o*c+a,t[5]=i*h+s*c+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function st(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function at(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ht(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function ct(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function lt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function pt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function ft(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function dt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=e[0],h=e[1],c=e[2],l=e[3],p=e[4],d=e[5];return Math.abs(n-u)<=f*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-h)<=f*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-c)<=f*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=f*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-p)<=f*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-d)<=f*Math.max(1,Math.abs(a),Math.abs(d))}var mt=tt,vt=ct;function _t(){var t=new d(9);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function gt(t){var e=new d(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function wt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Mt(t,e,n,r,i,o,s,a,u){var h=new d(9);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=i,h[5]=o,h[6]=s,h[7]=a,h[8]=u,h}function bt(t,e,n,r,i,o,s,a,u,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=h,t}function xt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Et(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Tt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=c*s-a*h,p=-c*o+a*u,f=h*o-s*u,d=n*l+r*p+i*f;return d?(d=1/d,t[0]=l*d,t[1]=(-c*r+i*h)*d,t[2]=(a*r-i*s)*d,t[3]=p*d,t[4]=(c*n-i*u)*d,t[5]=(-a*n+i*o)*d,t[6]=f*d,t[7]=(-h*n+r*u)*d,t[8]=(s*n-r*o)*d,t):null}function Lt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8];return t[0]=s*c-a*h,t[1]=i*h-r*c,t[2]=r*a-i*s,t[3]=a*u-o*c,t[4]=n*c-i*u,t[5]=i*o-n*a,t[6]=o*h-s*u,t[7]=r*u-n*h,t[8]=n*s-r*o,t}function Ct(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8];return e*(h*o-s*u)+n*(-h*i+s*a)+r*(u*i-o*a)}function St(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=n[0],f=n[1],d=n[2],m=n[3],v=n[4],_=n[5],y=n[6],g=n[7],w=n[8];return t[0]=p*r+f*s+d*h,t[1]=p*i+f*a+d*c,t[2]=p*o+f*u+d*l,t[3]=m*r+v*s+_*h,t[4]=m*i+v*a+_*c,t[5]=m*o+v*u+_*l,t[6]=y*r+g*s+w*h,t[7]=y*i+g*a+w*c,t[8]=y*o+g*u+w*l,t}function Pt(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=p*r+f*s+h,t[7]=p*i+f*a+c,t[8]=p*o+f*u+l,t}function At(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=Math.sin(n),f=Math.cos(n);return t[0]=f*r+p*s,t[1]=f*i+p*a,t[2]=f*o+p*u,t[3]=f*s-p*r,t[4]=f*a-p*i,t[5]=f*u-p*o,t[6]=h,t[7]=c,t[8]=l,t}function Rt(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function zt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ft(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function kt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ht(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,h=n*s,c=r*s,l=r*a,p=i*s,f=i*a,d=i*u,m=o*s,v=o*a,_=o*u;return t[0]=1-l-d,t[3]=c-_,t[6]=p+v,t[1]=c+_,t[4]=1-h-d,t[7]=f-m,t[2]=p-v,t[5]=f+m,t[8]=1-h-l,t}function Ot(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=n*a-r*s,g=n*u-i*s,w=n*h-o*s,M=r*u-i*a,b=r*h-o*a,x=i*h-o*u,E=c*m-l*d,T=c*v-p*d,L=c*_-f*d,C=l*v-p*m,S=l*_-f*m,P=p*_-f*v,A=y*P-g*S+w*C+M*L-b*T+x*E;return A?(A=1/A,t[0]=(a*P-u*S+h*C)*A,t[1]=(u*L-s*P-h*T)*A,t[2]=(s*S-a*L+h*E)*A,t[3]=(i*S-r*P-o*C)*A,t[4]=(n*P-i*L+o*T)*A,t[5]=(r*L-n*S-o*E)*A,t[6]=(m*x-v*b+_*M)*A,t[7]=(v*w-d*x-_*g)*A,t[8]=(d*b-m*w+_*y)*A,t):null}function Dt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Bt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function qt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Vt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Nt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Xt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function jt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Yt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Wt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],h=t[7],c=t[8],l=e[0],p=e[1],d=e[2],m=e[3],v=e[4],_=e[5],y=e[6],g=e[7],w=e[8];return Math.abs(n-l)<=f*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-p)<=f*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-d)<=f*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=f*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-v)<=f*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(a-_)<=f*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-y)<=f*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-g)<=f*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(c-w)<=f*Math.max(1,Math.abs(c),Math.abs(w))}var Ut=St,Gt=Nt;function Kt(){var t=new d(16);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Zt(t){var e=new d(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,n,r,i,o,s,a,u,h,c,l,p,f,m,v){var _=new d(16);return _[0]=t,_[1]=e,_[2]=n,_[3]=r,_[4]=i,_[5]=o,_[6]=s,_[7]=a,_[8]=u,_[9]=h,_[10]=c,_[11]=l,_[12]=p,_[13]=f,_[14]=m,_[15]=v,_}function $t(t,e,n,r,i,o,s,a,u,h,c,l,p,f,d,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=p,t[12]=f,t[13]=d,t[14]=m,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=n*a-r*s,g=n*u-i*s,w=n*h-o*s,M=r*u-i*a,b=r*h-o*a,x=i*h-o*u,E=c*m-l*d,T=c*v-p*d,L=c*_-f*d,C=l*v-p*m,S=l*_-f*m,P=p*_-f*v,A=y*P-g*S+w*C+M*L-b*T+x*E;return A?(A=1/A,t[0]=(a*P-u*S+h*C)*A,t[1]=(i*S-r*P-o*C)*A,t[2]=(m*x-v*b+_*M)*A,t[3]=(p*b-l*x-f*M)*A,t[4]=(u*L-s*P-h*T)*A,t[5]=(n*P-i*L+o*T)*A,t[6]=(v*w-d*x-_*g)*A,t[7]=(c*x-p*w+f*g)*A,t[8]=(s*S-a*L+h*E)*A,t[9]=(r*L-n*S-o*E)*A,t[10]=(d*b-m*w+_*y)*A,t[11]=(l*w-c*b-f*y)*A,t[12]=(a*T-s*C-u*E)*A,t[13]=(n*C-r*T+i*E)*A,t[14]=(m*g-d*M-v*y)*A,t[15]=(c*M-l*g+p*y)*A,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15];return t[0]=a*(p*_-f*v)-l*(u*_-h*v)+m*(u*f-h*p),t[1]=-(r*(p*_-f*v)-l*(i*_-o*v)+m*(i*f-o*p)),t[2]=r*(u*_-h*v)-a*(i*_-o*v)+m*(i*h-o*u),t[3]=-(r*(u*f-h*p)-a*(i*f-o*p)+l*(i*h-o*u)),t[4]=-(s*(p*_-f*v)-c*(u*_-h*v)+d*(u*f-h*p)),t[5]=n*(p*_-f*v)-c*(i*_-o*v)+d*(i*f-o*p),t[6]=-(n*(u*_-h*v)-s*(i*_-o*v)+d*(i*h-o*u)),t[7]=n*(u*f-h*p)-s*(i*f-o*p)+c*(i*h-o*u),t[8]=s*(l*_-f*m)-c*(a*_-h*m)+d*(a*f-h*l),t[9]=-(n*(l*_-f*m)-c*(r*_-o*m)+d*(r*f-o*l)),t[10]=n*(a*_-h*m)-s*(r*_-o*m)+d*(r*h-o*a),t[11]=-(n*(a*f-h*l)-s*(r*f-o*l)+c*(r*h-o*a)),t[12]=-(s*(l*v-p*m)-c*(a*v-u*m)+d*(a*p-u*l)),t[13]=n*(l*v-p*m)-c*(r*v-i*m)+d*(r*p-i*l),t[14]=-(n*(a*v-u*m)-s*(r*v-i*m)+d*(r*u-i*a)),t[15]=n*(a*p-u*l)-s*(r*p-i*l)+c*(r*u-i*a),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8],c=t[9],l=t[10],p=t[11],f=t[12],d=t[13],m=t[14],v=t[15];return(e*s-n*o)*(l*v-p*m)-(e*a-r*o)*(c*v-p*d)+(e*u-i*o)*(c*m-l*d)+(n*a-r*s)*(h*v-p*f)-(n*u-i*s)*(h*m-l*f)+(r*u-i*a)*(h*d-c*f)}function oe(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=e[9],f=e[10],d=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=n[0],w=n[1],M=n[2],b=n[3];return t[0]=g*r+w*a+M*l+b*m,t[1]=g*i+w*u+M*p+b*v,t[2]=g*o+w*h+M*f+b*_,t[3]=g*s+w*c+M*d+b*y,g=n[4],w=n[5],M=n[6],b=n[7],t[4]=g*r+w*a+M*l+b*m,t[5]=g*i+w*u+M*p+b*v,t[6]=g*o+w*h+M*f+b*_,t[7]=g*s+w*c+M*d+b*y,g=n[8],w=n[9],M=n[10],b=n[11],t[8]=g*r+w*a+M*l+b*m,t[9]=g*i+w*u+M*p+b*v,t[10]=g*o+w*h+M*f+b*_,t[11]=g*s+w*c+M*d+b*y,g=n[12],w=n[13],M=n[14],b=n[15],t[12]=g*r+w*a+M*l+b*m,t[13]=g*i+w*u+M*p+b*v,t[14]=g*o+w*h+M*f+b*_,t[15]=g*s+w*c+M*d+b*y,t}function se(t,e,n){var r,i,o,s,a,u,h,c,l,p,f,d,m=n[0],v=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=p,t[10]=f,t[11]=d,t[12]=r*m+a*v+l*_+e[12],t[13]=i*m+u*v+p*_+e[13],t[14]=o*m+h*v+f*_+e[14],t[15]=s*m+c*v+d*_+e[15]),t}function ae(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,o,s,a,u,h,c,l,p,d,m,v,_,y,g,w,M,b,x,E,T,L,C,S,P=r[0],A=r[1],R=r[2],z=Math.hypot(P,A,R);return z<f?null:(P*=z=1/z,A*=z,R*=z,i=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],u=e[1],h=e[2],c=e[3],l=e[4],p=e[5],d=e[6],m=e[7],v=e[8],_=e[9],y=e[10],g=e[11],w=P*P*s+o,M=A*P*s+R*i,b=R*P*s-A*i,x=P*A*s-R*i,E=A*A*s+o,T=R*A*s+P*i,L=P*R*s+A*i,C=A*R*s-P*i,S=R*R*s+o,t[0]=a*w+l*M+v*b,t[1]=u*w+p*M+_*b,t[2]=h*w+d*M+y*b,t[3]=c*w+m*M+g*b,t[4]=a*x+l*E+v*T,t[5]=u*x+p*E+_*T,t[6]=h*x+d*E+y*T,t[7]=c*x+m*E+g*T,t[8]=a*L+l*C+v*S,t[9]=u*L+p*C+_*S,t[10]=h*L+d*C+y*S,t[11]=c*L+m*C+g*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function he(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],h=e[8],c=e[9],l=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+h*r,t[5]=s*i+c*r,t[6]=a*i+l*r,t[7]=u*i+p*r,t[8]=h*i-o*r,t[9]=c*i-s*r,t[10]=l*i-a*r,t[11]=p*i-u*r,t}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],h=e[8],c=e[9],l=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-h*r,t[1]=s*i-c*r,t[2]=a*i-l*r,t[3]=u*i-p*r,t[8]=o*r+h*i,t[9]=s*r+c*i,t[10]=a*r+l*i,t[11]=u*r+p*i,t}function le(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],h=e[4],c=e[5],l=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+h*r,t[1]=s*i+c*r,t[2]=a*i+l*r,t[3]=u*i+p*r,t[4]=h*i-o*r,t[5]=c*i-s*r,t[6]=l*i-a*r,t[7]=p*i-u*r,t}function pe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function de(t,e,n){var r,i,o,s=n[0],a=n[1],u=n[2],h=Math.hypot(s,a,u);return h<f?null:(s*=h=1/h,a*=h,u*=h,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=s*s*o+i,t[1]=a*s*o+u*r,t[2]=u*s*o-a*r,t[3]=0,t[4]=s*a*o-u*r,t[5]=a*a*o+i,t[6]=u*a*o+s*r,t[7]=0,t[8]=s*u*o+a*r,t[9]=a*u*o-s*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ye(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=r+r,u=i+i,h=o+o,c=r*a,l=r*u,p=r*h,f=i*u,d=i*h,m=o*h,v=s*a,_=s*u,y=s*h;return t[0]=1-(f+m),t[1]=l+y,t[2]=p-_,t[3]=0,t[4]=l-y,t[5]=1-(c+m),t[6]=d+v,t[7]=0,t[8]=p+_,t[9]=d-v,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ge(t,e){var n=new d(3),r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=r*r+i*i+o*o+s*s;return l>0?(n[0]=2*(a*s+c*r+u*o-h*i)/l,n[1]=2*(u*s+c*i+h*r-a*o)/l,n[2]=2*(h*s+c*o+a*i-u*r)/l):(n[0]=2*(a*s+c*r+u*o-h*i),n[1]=2*(u*s+c*i+h*r-a*o),n[2]=2*(h*s+c*o+a*i-u*r)),ye(t,e,n),t}function we(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Me(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],h=e[9],c=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(u,h,c),t}function be(t,e){var n=new d(3);Me(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],s=e[0]*r,a=e[1]*i,u=e[2]*o,h=e[4]*r,c=e[5]*i,l=e[6]*o,p=e[8]*r,f=e[9]*i,m=e[10]*o,v=s+c+m,_=0;return v>0?(_=2*Math.sqrt(v+1),t[3]=.25*_,t[0]=(l-f)/_,t[1]=(p-u)/_,t[2]=(a-h)/_):s>c&&s>m?(_=2*Math.sqrt(1+s-c-m),t[3]=(l-f)/_,t[0]=.25*_,t[1]=(a+h)/_,t[2]=(p+u)/_):c>m?(_=2*Math.sqrt(1+c-s-m),t[3]=(p-u)/_,t[0]=(a+h)/_,t[1]=.25*_,t[2]=(l+f)/_):(_=2*Math.sqrt(1+m-s-c),t[3]=(a-h)/_,t[0]=(p+u)/_,t[1]=(l+f)/_,t[2]=.25*_),t}function xe(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3],u=i+i,h=o+o,c=s+s,l=i*u,p=i*h,f=i*c,d=o*h,m=o*c,v=s*c,_=a*u,y=a*h,g=a*c,w=r[0],M=r[1],b=r[2];return t[0]=(1-(d+v))*w,t[1]=(p+g)*w,t[2]=(f-y)*w,t[3]=0,t[4]=(p-g)*M,t[5]=(1-(l+v))*M,t[6]=(m+_)*M,t[7]=0,t[8]=(f+y)*b,t[9]=(m-_)*b,t[10]=(1-(l+d))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ee(t,e,n,r,i){var o=e[0],s=e[1],a=e[2],u=e[3],h=o+o,c=s+s,l=a+a,p=o*h,f=o*c,d=o*l,m=s*c,v=s*l,_=a*l,y=u*h,g=u*c,w=u*l,M=r[0],b=r[1],x=r[2],E=i[0],T=i[1],L=i[2],C=(1-(m+_))*M,S=(f+w)*M,P=(d-g)*M,A=(f-w)*b,R=(1-(p+_))*b,z=(v+y)*b,F=(d+g)*x,k=(v-y)*x,I=(1-(p+m))*x;return t[0]=C,t[1]=S,t[2]=P,t[3]=0,t[4]=A,t[5]=R,t[6]=z,t[7]=0,t[8]=F,t[9]=k,t[10]=I,t[11]=0,t[12]=n[0]+E-(C*E+A*T+F*L),t[13]=n[1]+T-(S*E+R*T+k*L),t[14]=n[2]+L-(P*E+z*T+I*L),t[15]=1,t}function Te(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,h=n*s,c=r*s,l=r*a,p=i*s,f=i*a,d=i*u,m=o*s,v=o*a,_=o*u;return t[0]=1-l-d,t[1]=c+_,t[2]=p-v,t[3]=0,t[4]=c-_,t[5]=1-h-d,t[6]=f+m,t[7]=0,t[8]=p+v,t[9]=f-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Le(t,e,n,r,i,o,s){var a=1/(n-e),u=1/(i-r),h=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t}function Ce(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function Se(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+a),h=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(s-a)*u*.5,t[9]=(i-o)*h*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Pe(t,e,n,r,i,o,s){var a=1/(e-n),u=1/(r-i),h=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(s+o)*h,t[15]=1,t}function Ae(t,e,n,r){var i,o,s,a,u,h,c,l,p,d,m=e[0],v=e[1],_=e[2],y=r[0],g=r[1],w=r[2],M=n[0],b=n[1],x=n[2];return Math.abs(m-M)<f&&Math.abs(v-b)<f&&Math.abs(_-x)<f?te(t):(c=m-M,l=v-b,p=_-x,i=g*(p*=d=1/Math.hypot(c,l,p))-w*(l*=d),o=w*(c*=d)-y*p,s=y*l-g*c,(d=Math.hypot(i,o,s))?(i*=d=1/d,o*=d,s*=d):(i=0,o=0,s=0),a=l*s-p*o,u=p*i-c*s,h=c*o-l*i,(d=Math.hypot(a,u,h))?(a*=d=1/d,u*=d,h*=d):(a=0,u=0,h=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=o,t[5]=u,t[6]=l,t[7]=0,t[8]=s,t[9]=h,t[10]=p,t[11]=0,t[12]=-(i*m+o*v+s*_),t[13]=-(a*m+u*v+h*_),t[14]=-(c*m+l*v+p*_),t[15]=1,t)}function Re(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=r[0],u=r[1],h=r[2],c=i-n[0],l=o-n[1],p=s-n[2],f=c*c+l*l+p*p;f>0&&(c*=f=1/Math.sqrt(f),l*=f,p*=f);var d=u*p-h*l,m=h*c-a*p,v=a*l-u*c;return(f=d*d+m*m+v*v)>0&&(d*=f=1/Math.sqrt(f),m*=f,v*=f),t[0]=d,t[1]=m,t[2]=v,t[3]=0,t[4]=l*v-p*m,t[5]=p*d-c*v,t[6]=c*m-l*d,t[7]=0,t[8]=c,t[9]=l,t[10]=p,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function ze(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Fe(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ke(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Ie(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function He(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Oe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function De(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Be(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],h=t[7],c=t[8],l=t[9],p=t[10],d=t[11],m=t[12],v=t[13],_=t[14],y=t[15],g=e[0],w=e[1],M=e[2],b=e[3],x=e[4],E=e[5],T=e[6],L=e[7],C=e[8],S=e[9],P=e[10],A=e[11],R=e[12],z=e[13],F=e[14],k=e[15];return Math.abs(n-g)<=f*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-w)<=f*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-M)<=f*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-b)<=f*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-x)<=f*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-E)<=f*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-T)<=f*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-L)<=f*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(c-C)<=f*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(l-S)<=f*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(p-P)<=f*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-A)<=f*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-R)<=f*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(v-z)<=f*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(_-F)<=f*Math.max(1,Math.abs(_),Math.abs(F))&&Math.abs(y-k)<=f*Math.max(1,Math.abs(y),Math.abs(k))}var qe=oe,Ve=Ie;function Ne(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Xe(t){var e=new d(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function je(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Ye(t,e,n){var r=new d(3);return r[0]=t,r[1]=e,r[2]=n,r}function We(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ue(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ge(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ke(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ze(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function on(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function sn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function hn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function cn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ln(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function pn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function fn(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}function dn(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function mn(t,e,n,r,i,o){var s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,h=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*u+r[0]*h+i[0]*c,t[1]=e[1]*a+n[1]*u+r[1]*h+i[1]*c,t[2]=e[2]*a+n[2]*u+r[2]*h+i[2]*c,t}function vn(t,e,n,r,i,o){var s=1-o,a=s*s,u=o*o,h=a*s,c=3*o*a,l=3*u*s,p=u*o;return t[0]=e[0]*h+n[0]*c+r[0]*l+i[0]*p,t[1]=e[1]*h+n[1]*c+r[1]*l+i[1]*p,t[2]=e[2]*h+n[2]*c+r[2]*l+i[2]*p,t}function _n(t,e){e=e||1;var n=2*m()*Math.PI,r=2*m()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function yn(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function gn(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function wn(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],h=e[2],c=i*h-o*u,l=o*a-r*h,p=r*u-i*a,f=i*p-o*l,d=o*c-r*p,m=r*l-i*c,v=2*s;return c*=v,l*=v,p*=v,f*=2,d*=2,m*=2,t[0]=a+c+f,t[1]=u+l+d,t[2]=h+p+m,t}function Mn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function bn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function xn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function En(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),h=u&&pn(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function Tn(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ln(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Cn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Sn(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=f*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=f*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=f*Math.max(1,Math.abs(i),Math.abs(a))}var Pn,An=Ke,Rn=Ze,zn=Qe,Fn=sn,kn=an,In=je,Hn=un,On=(Pn=Ne(),function(t,e,n,r,i,o){var s,a;for(e||(e=3),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,s=n;s<a;s+=e)Pn[0]=t[s],Pn[1]=t[s+1],Pn[2]=t[s+2],i(Pn,Pn,o),t[s]=Pn[0],t[s+1]=Pn[1],t[s+2]=Pn[2];return t});function Dn(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Bn(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function qn(t,e,n,r){var i=new d(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Vn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Nn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function Xn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function jn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Yn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Wn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Un(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Gn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Kn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Zn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Qn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Jn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $n(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function er(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function nr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function rr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ir(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function or(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function sr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function ar(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ur(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],s=n[0]*r[3]-n[3]*r[0],a=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],h=n[2]*r[3]-n[3]*r[2],c=e[0],l=e[1],p=e[2],f=e[3];return t[0]=l*h-p*u+f*a,t[1]=-c*h+p*s-f*o,t[2]=c*u-l*s+f*i,t[3]=-c*a+l*o-p*i,t}function hr(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function cr(t,e){var n,r,i,o,s,a;e=e||1;do{s=(n=2*m()-1)*n+(r=2*m()-1)*r}while(s>=1);do{a=(i=2*m()-1)*i+(o=2*m()-1)*o}while(a>=1);var u=Math.sqrt((1-s)/a);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*o*u,t}function lr(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function pr(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2],h=n[3],c=h*r+a*o-u*i,l=h*i+u*r-s*o,p=h*o+s*i-a*r,f=-s*r-a*i-u*o;return t[0]=c*h+f*-s+l*-u-p*-a,t[1]=l*h+f*-a+p*-s-c*-u,t[2]=p*h+f*-u+c*-a-l*-s,t[3]=e[3],t}function fr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function dr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function mr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function vr(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],u=e[2],h=e[3];return Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=f*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=f*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=f*Math.max(1,Math.abs(o),Math.abs(h))}var _r=jn,yr=Yn,gr=Wn,wr=tr,Mr=er,br=nr,xr=rr,Er=function(){var t=Dn();return function(e,n,r,i,o,s){var a,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,a=r;a<u;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();function Tr(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Lr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Cr(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Sr(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>f?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Pr(t,e){var n=ii(t,e);return Math.acos(2*n*n-1)}function Ar(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],h=n[2],c=n[3];return t[0]=r*c+s*a+i*h-o*u,t[1]=i*c+s*u+o*a-r*h,t[2]=o*c+s*h+r*u-i*a,t[3]=s*c-r*a-i*u-o*h,t}function Rr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-r*a,t}function zr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*a,t[1]=i*u+s*a,t[2]=o*u+r*a,t[3]=s*u-i*a,t}function Fr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t}function kr(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Ir(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=Math.exp(o),u=s>0?a*Math.sin(s)/s:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=a*Math.cos(s),t}function Hr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Or(t,e,n){return Hr(t,e),ri(t,t,n),Ir(t,t),t}function Dr(t,e,n,r){var i,o,s,a,u,h=e[0],c=e[1],l=e[2],p=e[3],d=n[0],m=n[1],v=n[2],_=n[3];return(o=h*d+c*m+l*v+p*_)<0&&(o=-o,d=-d,m=-m,v=-v,_=-_),1-o>f?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,u=Math.sin(r*i)/s):(a=1-r,u=r),t[0]=a*h+u*d,t[1]=a*c+u*m,t[2]=a*l+u*v,t[3]=a*p+u*_,t}function Br(t){var e=m(),n=m(),r=m(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function qr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t}function Vr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Nr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}function Xr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),u=Math.cos(n),h=Math.sin(r),c=Math.cos(r);return t[0]=o*u*c-s*a*h,t[1]=s*a*c+o*u*h,t[2]=s*u*h-o*a*c,t[3]=s*u*c+o*a*h,t}function jr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Yr,Wr,Ur,Gr,Kr,Zr,Qr=Bn,Jr=qn,$r=Vn,ti=Nn,ei=Xn,ni=Ar,ri=Jn,ii=ar,oi=hr,si=nr,ai=si,ui=rr,hi=ui,ci=sr,li=mr,pi=vr,fi=(Yr=Ne(),Wr=Ye(1,0,0),Ur=Ye(0,1,0),function(t,e,n){var r=pn(e,n);return r<-.999999?(fn(Yr,Wr,e),In(Yr)<1e-6&&fn(Yr,Ur,e),ln(Yr,Yr),Cr(t,Yr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(fn(Yr,e,n),t[0]=Yr[0],t[1]=Yr[1],t[2]=Yr[2],t[3]=1+r,ci(t,t))}),di=(Gr=Tr(),Kr=Tr(),function(t,e,n,r,i,o){return Dr(Gr,e,i,o),Dr(Kr,n,r,o),Dr(t,Gr,Kr,2*o*(1-o)),t}),mi=(Zr=_t(),function(t,e,n,r){return Zr[0]=n[0],Zr[3]=n[1],Zr[6]=n[2],Zr[1]=r[0],Zr[4]=r[1],Zr[7]=r[2],Zr[2]=-e[0],Zr[5]=-e[1],Zr[8]=-e[2],ci(t,Nr(t,Zr))});function vi(){var t=new d(8);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function _i(t){var e=new d(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function yi(t,e,n,r,i,o,s,a){var u=new d(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u}function gi(t,e,n,r,i,o,s){var a=new d(8);a[0]=t,a[1]=e,a[2]=n,a[3]=r;var u=.5*i,h=.5*o,c=.5*s;return a[4]=u*r+h*n-c*e,a[5]=h*r+c*t-u*n,a[6]=c*r+u*e-h*t,a[7]=-u*t-h*e-c*n,a}function wi(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],s=e[0],a=e[1],u=e[2],h=e[3];return t[0]=s,t[1]=a,t[2]=u,t[3]=h,t[4]=r*h+i*u-o*a,t[5]=i*h+o*s-r*u,t[6]=o*h+r*a-i*s,t[7]=-r*s-i*a-o*u,t}function Mi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function bi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function xi(t,e){var n=Tr();be(n,e);var r=new d(3);return we(r,e),wi(t,n,r),t}function Ei(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ti(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Li(t,e,n,r,i,o,s,a,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t}var Ci=$r;function Si(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Pi=$r;function Ai(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Ri(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],s=-e[0],a=-e[1],u=-e[2],h=e[3];return t[0]=2*(n*h+o*s+r*u-i*a),t[1]=2*(r*h+o*a+i*s-n*u),t[2]=2*(i*h+o*u+n*a-r*s),t}function zi(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=.5*n[0],u=.5*n[1],h=.5*n[2],c=e[4],l=e[5],p=e[6],f=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=s*a+i*h-o*u+c,t[5]=s*u+o*a-r*h+l,t[6]=s*h+r*u-i*a+p,t[7]=-r*a-i*u-o*h+f,t}function Fi(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=a*s+c*r+u*o-h*i,p=u*s+c*i+h*r-a*o,f=h*s+c*o+a*i-u*r,d=c*s-a*r-u*i-h*o;return Rr(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+p*o-f*i,t[5]=p*s+d*i+f*r-l*o,t[6]=f*s+d*o+l*i-p*r,t[7]=d*s-l*r-p*i-f*o,t}function ki(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=a*s+c*r+u*o-h*i,p=u*s+c*i+h*r-a*o,f=h*s+c*o+a*i-u*r,d=c*s-a*r-u*i-h*o;return zr(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+p*o-f*i,t[5]=p*s+d*i+f*r-l*o,t[6]=f*s+d*o+l*i-p*r,t[7]=d*s-l*r-p*i-f*o,t}function Ii(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=a*s+c*r+u*o-h*i,p=u*s+c*i+h*r-a*o,f=h*s+c*o+a*i-u*r,d=c*s-a*r-u*i-h*o;return Fr(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+p*o-f*i,t[5]=p*s+d*i+f*r-l*o,t[6]=f*s+d*o+l*i-p*r,t[7]=d*s-l*r-p*i-f*o,t}function Hi(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],h=e[2],c=e[3];return t[0]=a*s+c*r+u*o-h*i,t[1]=u*s+c*i+h*r-a*o,t[2]=h*s+c*o+a*i-u*r,t[3]=c*s-a*r-u*i-h*o,a=e[4],u=e[5],h=e[6],c=e[7],t[4]=a*s+c*r+u*o-h*i,t[5]=u*s+c*i+h*r-a*o,t[6]=h*s+c*o+a*i-u*r,t[7]=c*s-a*r-u*i-h*o,t}function Oi(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],h=n[2],c=n[3];return t[0]=r*c+s*a+i*h-o*u,t[1]=i*c+s*u+o*a-r*h,t[2]=o*c+s*h+r*u-i*a,t[3]=s*c-r*a-i*u-o*h,a=n[4],u=n[5],h=n[6],c=n[7],t[4]=r*c+s*a+i*h-o*u,t[5]=i*c+s*u+o*a-r*h,t[6]=o*c+s*h+r*u-i*a,t[7]=s*c-r*a-i*u-o*h,t}function Di(t,e,n,r){if(Math.abs(r)<f)return Ei(t,e);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var o=Math.sin(r),s=o*n[0]/i,a=o*n[1]/i,u=o*n[2]/i,h=Math.cos(r),c=e[0],l=e[1],p=e[2],d=e[3];t[0]=c*h+d*s+l*u-p*a,t[1]=l*h+d*a+p*s-c*u,t[2]=p*h+d*u+c*a-l*s,t[3]=d*h-c*s-l*a-p*u;var m=e[4],v=e[5],_=e[6],y=e[7];return t[4]=m*h+y*s+v*u-_*a,t[5]=v*h+y*a+_*s-m*u,t[6]=_*h+y*u+m*a-v*s,t[7]=y*h-m*s-v*a-_*u,t}function Bi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function qi(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[4],u=n[5],h=n[6],c=n[7],l=e[4],p=e[5],f=e[6],d=e[7],m=n[0],v=n[1],_=n[2],y=n[3];return t[0]=r*y+s*m+i*_-o*v,t[1]=i*y+s*v+o*m-r*_,t[2]=o*y+s*_+r*v-i*m,t[3]=s*y-r*m-i*v-o*_,t[4]=r*c+s*a+i*h-o*u+l*y+d*m+p*_-f*v,t[5]=i*c+s*u+o*a-r*h+p*y+d*v+f*m-l*_,t[6]=o*c+s*h+r*u-i*a+f*y+d*_+l*v-p*m,t[7]=s*c-r*a-i*u-o*h+d*y-l*m-p*v-f*_,t}var Vi=qi;function Ni(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Xi=ii;function ji(t,e,n,r){var i=1-r;return Xi(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Yi(t,e){var n=Ki(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Wi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ui=si,Gi=Ui,Ki=ui,Zi=Ki;function Qi(t,e){var n=Ki(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,s=e[3]/n,a=e[4],u=e[5],h=e[6],c=e[7],l=r*a+i*u+o*h+s*c;t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=(a-r*l)/n,t[5]=(u-i*l)/n,t[6]=(h-o*l)/n,t[7]=(c-s*l)/n}return t}function Ji(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function $i(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function to(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],h=t[7],c=e[0],l=e[1],p=e[2],d=e[3],m=e[4],v=e[5],_=e[6],y=e[7];return Math.abs(n-c)<=f*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-l)<=f*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-p)<=f*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-d)<=f*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-m)<=f*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-v)<=f*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-_)<=f*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(h-y)<=f*Math.max(1,Math.abs(h),Math.abs(y))}function eo(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}function no(t){var e=new d(2);return e[0]=t[0],e[1]=t[1],e}function ro(t,e){var n=new d(2);return n[0]=t,n[1]=e,n}function io(t,e){return t[0]=e[0],t[1]=e[1],t}function oo(t,e,n){return t[0]=e,t[1]=n,t}function so(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ao(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function uo(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function ho(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function co(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function lo(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function po(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function fo(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function mo(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function vo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function _o(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function yo(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function go(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function wo(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Mo(t){var e=t[0],n=t[1];return e*e+n*n}function bo(t,e){return t[0]=-e[0],t[1]=-e[1],t}function xo(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Eo(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function To(t,e){return t[0]*e[0]+t[1]*e[1]}function Lo(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function Co(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function So(t,e){e=e||1;var n=2*m()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Po(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Ao(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function Ro(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function zo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Fo(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),a=Math.cos(r);return t[0]=i*a-o*s+n[0],t[1]=i*s+o*a+n[1],t}function ko(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),a=s&&(n*i+r*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function Io(t){return t[0]=0,t[1]=0,t}function Ho(t){return"vec2("+t[0]+", "+t[1]+")"}function Oo(t,e){return t[0]===e[0]&&t[1]===e[1]}function Do(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=f*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=f*Math.max(1,Math.abs(r),Math.abs(o))}var Bo=wo,qo=ao,Vo=uo,No=ho,Xo=yo,jo=go,Yo=Mo,Wo=function(){var t=eo();return function(e,n,r,i,o,s){var a,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,a=r;a<u;a+=n)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}()},840:function(t,e,n){var r;!function(i,o,s,a){"use strict";var u=["","webkit","moz","MS","ms","o"],h=o.createElement("div"),c=Math.round,l=Math.abs,p=Date.now;function f(t,e,n){return setTimeout(g(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function v(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}function _(t,e){return v(t,e,!0)}function y(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&v(r,n)}function g(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function M(t,e){return t===a?e:t}function b(t,e,n){m(L(e),(function(e){t.addEventListener(e,n,!1)}))}function x(t,e,n){m(L(e),(function(e){t.removeEventListener(e,n,!1)}))}function E(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function T(t,e){return t.indexOf(e)>-1}function L(t){return t.trim().split(/\s+/g)}function C(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function S(t){return Array.prototype.slice.call(t,0)}function P(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];C(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function A(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<u.length;){if((r=(n=u[o])?n+i:e)in t)return r;o++}return a}var R=1;function z(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}var F="ontouchstart"in i,k=A(i,"PointerEvent")!==a,I=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),H="touch",O="mouse",D=["x","y"],B=["clientX","clientY"];function q(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function V(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,s=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=N(e)),i>1&&!n.firstMultiple?n.firstMultiple=N(e):1===i&&(n.firstMultiple=!1);var o,s,u=n.firstInput,h=n.firstMultiple,c=h?h.center:u.center,f=e.center=X(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-u.timeStamp,e.angle=W(c,f),e.distance=Y(c,f),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=j(e.deltaX,e.deltaY),e.scale=h?(o=h.pointers,Y((s=r)[0],s[1],B)/Y(o[0],o[1],B)):1,e.rotation=h?function(t,e){return W(e[1],e[0],B)-W(t[1],t[0],B)}(h.pointers,r):0,function(t,e){var n,r,i,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===a)){var h=s.deltaX-e.deltaX,c=s.deltaY-e.deltaY,p=function(t,e,n){return{x:e/t||0,y:n/t||0}}(u,h,c);r=p.x,i=p.y,n=l(p.x)>l(p.y)?p.x:p.y,o=j(h,c),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var d=t.element;E(e.srcEvent.target,d)&&(d=e.srcEvent.target),e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function N(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:c(t.pointers[n].clientX),clientY:c(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:X(e),deltaX:t.deltaX,deltaY:t.deltaY}}function X(t){var e=t.length;if(1===e)return{x:c(t[0].clientX),y:c(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:c(n/e),y:c(r/e)}}function j(t,e){return t===e?1:l(t)>=l(e)?t>0?2:4:e>0?8:16}function Y(t,e,n){n||(n=D);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function W(t,e,n){n||(n=D);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}q.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(z(this.element),this.evWin,this.domHandler)}};var U={mousedown:1,mousemove:2,mouseup:4},G="mousedown",K="mousemove mouseup";function Z(){this.evEl=G,this.evWin=K,this.allow=!0,this.pressed=!1,q.apply(this,arguments)}y(Z,q,{handler:function(t){var e=U[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&this.allow&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:O,srcEvent:t}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},J={2:H,3:"pen",4:O,5:"kinect"},$="pointerdown",tt="pointermove pointerup pointercancel";function et(){this.evEl=$,this.evWin=tt,q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&($="MSPointerDown",tt="MSPointerMove MSPointerUp MSPointerCancel"),y(et,q,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Q[r],o=J[t.pointerType]||t.pointerType,s=o==H,a=C(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&i&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var nt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",it="touchstart touchmove touchend touchcancel";function ot(){this.evTarget=rt,this.evWin=it,this.started=!1,q.apply(this,arguments)}function st(t,e){var n=S(t.touches),r=S(t.changedTouches);return 12&e&&(n=P(n.concat(r),"identifier",!0)),[n,r]}y(ot,q,{handler:function(t){var e=nt[t.type];if(1===e&&(this.started=!0),this.started){var n=st.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:H,srcEvent:t})}}});var at={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ut="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=ut,this.targetIds={},q.apply(this,arguments)}function ct(t,e){var n=S(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=S(t.changedTouches),a=[],u=this.target;if(o=n.filter((function(t){return E(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[P(o.concat(a),"identifier",!0),a]:void 0}function lt(){q.apply(this,arguments);var t=g(this.handler,this);this.touch=new ht(this.manager,t),this.mouse=new Z(this.manager,t)}y(ht,q,{handler:function(t){var e=at[t.type],n=ct.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:H,srcEvent:t})}}),y(lt,q,{handler:function(t,e,n){var r=n.pointerType==H,i=n.pointerType==O;if(r)this.mouse.allow=!1;else if(i&&!this.mouse.allow)return;12&e&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var pt=A(h.style,"touchAction"),ft=pt!==a,dt="compute",mt="auto",vt="manipulation",_t="none",yt="pan-x",gt="pan-y";function wt(t,e){this.manager=t,this.set(e)}wt.prototype={set:function(t){t==dt&&(t=this.compute()),ft&&(this.manager.element.style[pt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(T(t,_t))return _t;var e=T(t,yt),n=T(t,gt);return e&&n?"pan-x pan-y":e||n?e?yt:gt:T(t,vt)?vt:mt}(t.join(" "))},preventDefaults:function(t){if(!ft){var e=t.srcEvent,n=t.offsetDirection;if(!this.manager.session.prevented){var r=this.actions,i=T(r,_t),o=T(r,gt),s=T(r,yt);return i||o&&6&n||s&&24&n?this.preventSrc(e):void 0}e.preventDefault()}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Mt=32;function bt(t){this.id=R++,this.manager=null,this.options=_(t||{},this.defaults),this.options.enable=M(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function xt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Et(t,e){var n=e.manager;return n?n.get(t):t}function Tt(){bt.apply(this,arguments)}function Lt(){Tt.apply(this,arguments),this.pX=null,this.pY=null}function Ct(){Tt.apply(this,arguments)}function St(){bt.apply(this,arguments),this._timer=null,this._input=null}function Pt(){Tt.apply(this,arguments)}function At(){Tt.apply(this,arguments)}function Rt(){bt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function zt(t,e){return(e=e||{}).recognizers=M(e.recognizers,zt.defaults.preset),new Ft(t,e)}function Ft(t,e){e=e||{},this.options=_(e,zt.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=new(this.options.inputClass||(k?et:I?ht:F?lt:Z))(this,V),this.touchAction=new wt(this,this.options.touchAction),kt(this,!0),m(e.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function kt(t,e){var n=t.element;m(t.options.cssProps,(function(t,r){n.style[A(n.style,r)]=e?t:""}))}bt.prototype={defaults:{},set:function(t){return v(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Et(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=Et(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Et(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=Et(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(r){e.manager.emit(e.options.event+(r?function(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}(n):""),t)}n<8&&r(!0),r(),n>=8&&r(!0)},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Mt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=v({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=Mt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},y(Tt,bt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Mt}}),y(Lt,Tt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(gt),24&t&&e.push(yt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Tt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=xt(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),y(Ct,Tt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),y(St,bt,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[mt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Mt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),y(Pt,Tt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),y(At,Tt,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return Lt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.velocity:6&n?e=t.velocityX:24&n&&(e=t.velocityY),this._super.attrTest.call(this,t)&&n&t.direction&&t.distance>this.options.threshold&&l(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=xt(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),y(Rt,bt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[vt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||Y(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Mt},failTimeout:function(){return this._timer=f((function(){this.state=Mt}),this.options.interval,this),Mt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),zt.VERSION="2.0.4",zt.defaults={domEvents:!1,touchAction:dt,enable:!0,inputTarget:null,inputClass:null,preset:[[Pt,{enable:!1}],[Ct,{enable:!1},["rotate"]],[At,{direction:6}],[Lt,{direction:6},["swipe"]],[Rt],[Rt,{event:"doubletap",taps:2},["tap"]],[St]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ft.prototype={set:function(t){return v(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof bt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(C(e,t),1),this.touchAction.update(),this},on:function(t,e){var n=this.handlers;return m(L(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this},off:function(t,e){var n=this.handlers;return m(L(t),(function(t){e?n[t].splice(C(n[t],e),1):delete n[t]})),this},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&kt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},v(zt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Mt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ft,Input:q,TouchAction:wt,TouchInput:ht,MouseInput:Z,PointerEventInput:et,TouchMouseInput:lt,SingleTouchInput:ot,Recognizer:bt,AttrRecognizer:Tt,Tap:Rt,Pan:Lt,Swipe:At,Pinch:Ct,Rotate:Pt,Press:St,on:b,off:x,each:m,merge:_,extend:v,inherit:y,bindFn:g,prefixed:A}),n.amdO?(r=function(){return zt}.call(e,n,e,t))===a||(t.exports=r):t.exports?t.exports=zt:i.Hammer=zt}(window,document)},1154:function(t,e,n){"use strict";var r=n(5696),i=n(7691),o=n(6939).setTransform,s=n(6112);function a(t,e,n,r,i){(i=i||{}).perspective=i.perspective||{},i.perspective.extraTransforms=null!=i.perspective.extraTransforms?i.perspective.extraTransforms:"",this._domElement=t,this._parentDomElement=e,this._view=n,this._coords={},this._perspective={},this.setPosition(r),this._parentDomElement.appendChild(this._domElement),this.setPerspective(i.perspective),this._visible=!0,this._position={x:0,y:0}}r(a),a.prototype.destroy=function(){this._parentDomElement.removeChild(this._domElement),s(this)},a.prototype.domElement=function(){return this._domElement},a.prototype.position=function(){return this._coords},a.prototype.setPosition=function(t){for(var e in t)this._coords[e]=t[e];this._update()},a.prototype.perspective=function(){return this._perspective},a.prototype.setPerspective=function(t){for(var e in t)this._perspective[e]=t[e];this._update()},a.prototype.show=function(){this._visible||(this._visible=!0,this._update())},a.prototype.hide=function(){this._visible&&(this._visible=!1,this._update())},a.prototype._update=function(){var t,e,n=this._domElement,r=this._coords,i=this._position,o=!1;if(this._visible){var s=this._view;this._perspective.radius?(o=!0,this._setEmbeddedPosition(s,r)):(s.coordinatesToScreen(r,i),t=i.x,e=i.y,null!=t&&null!=e&&(o=!0,this._setPosition(t,e)))}o?(n.style.display="block",n.style.position="absolute"):(n.style.display="none",n.style.position="")},a.prototype._setEmbeddedPosition=function(t,e){var n=t.coordinatesToPerspectiveTransform(e,this._perspective.radius,this._perspective.extraTransforms);o(this._domElement,n)},a.prototype._setPosition=function(t,e){i(this._domElement,t,e,this._perspective.extraTransforms)},t.exports=a},3561:function(t,e,n){"use strict";var r=n(5696),i=n(1154),o=n(6929),s=n(7691),a=n(6939).setAbsolute,u=n(6939).setOverflowHidden,h=n(6939).setOverflowVisible,c=n(6939).setNullSize,l=n(6939).setPixelSize,p=n(6939).setWithVendorPrefix("pointer-events"),f=n(6112);function d(t,e,n,r,i){i=i||{},this._parentDomElement=t,this._stage=e,this._view=n,this._renderLoop=r,this._hotspots=[],this._visible=!0,this._rect=i.rect,this._visibilityOrRectChanged=!0,this._stageWidth=null,this._stageHeight=null,this._tmpRect={},this._hotspotContainerWrapper=document.createElement("div"),a(this._hotspotContainerWrapper),p(this._hotspotContainerWrapper,"none"),this._parentDomElement.appendChild(this._hotspotContainerWrapper),this._hotspotContainer=document.createElement("div"),a(this._hotspotContainer),p(this._hotspotContainer,"all"),this._hotspotContainerWrapper.appendChild(this._hotspotContainer),this._updateHandler=this._update.bind(this),this._renderLoop.addEventListener("afterRender",this._updateHandler)}r(d),d.prototype.destroy=function(){for(;this._hotspots.length;)this.destroyHotspot(this._hotspots[0]);this._parentDomElement.removeChild(this._hotspotContainerWrapper),this._renderLoop.removeEventListener("afterRender",this._updateHandler),f(this)},d.prototype.domElement=function(){return this._hotspotContainer},d.prototype.setRect=function(t){this._rect=t,this._visibilityOrRectChanged=!0},d.prototype.rect=function(){return this._rect},d.prototype.createHotspot=function(t,e,n){e=e||{};var r=new i(t,this._hotspotContainer,this._view,e,n);return this._hotspots.push(r),r._update(),this.emit("hotspotsChange"),r},d.prototype.hasHotspot=function(t){return this._hotspots.indexOf(t)>=0},d.prototype.listHotspots=function(){return[].concat(this._hotspots)},d.prototype.destroyHotspot=function(t){var e=this._hotspots.indexOf(t);if(e<0)throw new Error("No such hotspot");this._hotspots.splice(e,1),t.destroy(),this.emit("hotspotsChange")},d.prototype.hide=function(){this._visible&&(this._visible=!1,this._visibilityOrRectChanged=!0,this._update())},d.prototype.show=function(){this._visible||(this._visible=!0,this._visibilityOrRectChanged=!0,this._update())},d.prototype._update=function(){var t=this._hotspotContainerWrapper,e=this._stage.width(),n=this._stage.height(),r=this._tmpRect;if(this._visibilityOrRectChanged||this._rect&&(e!==this._stageWidth||n!==this._stageHeight)){var i=this._visible;t.style.display=i?"block":"none",i&&(this._rect?(o(e,n,this._rect,r),s(t,e*r.x,n*r.y),l(t,e*r.width,n*r.height),u(t)):(s(t,0,0),c(t),h(t))),this._stageWidth=e,this._stageHeight=n,this._visibilityOrRectChanged=!1}for(var a=0;a<this._hotspots.length;a++)this._hotspots[a]._update()},t.exports=d},4221:function(t,e,n){"use strict";var r=n(5696),i=n(8804),o=n(6112);function s(t,e,n,r,i){i=i||{};var o=this;this._source=t,this._geometry=e,this._view=n,this._textureStore=r,this._effects=i.effects||{},this._fixedLevelIndex=null,this._viewChangeHandler=function(){o.emit("viewChange",o.view())},this._view.addEventListener("change",this._viewChangeHandler),this._textureStoreChangeHandler=function(){o.emit("textureStoreChange",o.textureStore())},this._textureStore.addEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureInvalid",this._textureStoreChangeHandler)}r(s),s.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._textureStore.removeEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureInvalid",this._textureStoreChangeHandler),o(this)},s.prototype.source=function(){return this._source},s.prototype.geometry=function(){return this._geometry},s.prototype.view=function(){return this._view},s.prototype.textureStore=function(){return this._textureStore},s.prototype.effects=function(){return this._effects},s.prototype.setEffects=function(t){this._effects=t,this.emit("effectsChange",this._effects)},s.prototype.mergeEffects=function(t){i(this._effects,t),this.emit("effectsChange",this._effects)},s.prototype.fixedLevel=function(){return this._fixedLevelIndex},s.prototype.setFixedLevel=function(t){if(t!==this._fixedLevelIndex){if(null!=t&&(t>=this._geometry.levelList.length||t<0))throw new Error("Level index out of range: "+t);this._fixedLevelIndex=t,this.emit("fixedLevelChange",this._fixedLevelIndex)}},s.prototype._selectLevel=function(){return null!=this._fixedLevelIndex?this._geometry.levelList[this._fixedLevelIndex]:this._view.selectLevel(this._geometry.selectableLevelList)},s.prototype.visibleTiles=function(t){var e=this._selectLevel();return this._geometry.visibleTiles(this._view,e,t)},s.prototype.pinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),r=0;r<n.length;r++)this._textureStore.pin(n[r])},s.prototype.unpinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),r=0;r<n.length;r++)this._textureStore.unpin(n[r])},s.prototype.pinFirstLevel=function(){return this.pinLevel(0)},s.prototype.unpinFirstLevel=function(){return this.unpinLevel(0)},t.exports=s},3344:function(t,e,n){"use strict";function r(t){this.constructor.super_.apply(this,arguments),this.message=t}n(5003)(r,Error),t.exports=r},3036:function(t,e,n){"use strict";var r=n(5696),i=n(6112);function o(t){var e=this;this._stage=t,this._running=!1,this._rendering=!1,this._requestHandle=null,this._boundLoop=this._loop.bind(this),this._renderInvalidHandler=function(){e._rendering||e.renderOnNextFrame()},this._stage.addEventListener("renderInvalid",this._renderInvalidHandler)}r(o),o.prototype.destroy=function(){this.stop(),this._stage.removeEventListener("renderInvalid",this._renderInvalidHandler),i(this)},o.prototype.stage=function(){return this._stage},o.prototype.start=function(){this._running=!0,this.renderOnNextFrame()},o.prototype.stop=function(){this._requestHandle&&(window.cancelAnimationFrame(this._requestHandle),this._requestHandle=null),this._running=!1},o.prototype.renderOnNextFrame=function(){this._running&&!this._requestHandle&&(this._requestHandle=window.requestAnimationFrame(this._boundLoop))},o.prototype._loop=function(){if(!this._running)throw new Error("Render loop running while in stopped state");this._requestHandle=null,this._rendering=!0,this.emit("beforeRender"),this._rendering=!1,this._stage.render(),this.emit("afterRender")},t.exports=o},5214:function(t,e,n){"use strict";var r=n(4221),i=n(7559),o=n(3561),s=n(5696),a=n(1227),u=n(3120),h=n(3969),c=n(9821),l=n(6112);function p(t,e){this._viewer=t,this._view=e,this._layers=[],this._hotspotContainer=new o(t._controlContainer,t.stage(),this._view,t.renderLoop()),this._movement=null,this._movementStartTime=null,this._movementStep=null,this._movementParams=null,this._movementCallback=null,this._updateMovementHandler=this._updateMovement.bind(this),this._updateHotspotContainerHandler=this._updateHotspotContainer.bind(this),this._viewer.addEventListener("sceneChange",this._updateHotspotContainerHandler),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._view.addEventListener("change",this._viewChangeHandler),this._updateHotspotContainer()}s(p),p.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._viewer.removeEventListener("sceneChange",this._updateHotspotContainerHandler),this._movement&&this.stopMovement(),this._hotspotContainer.destroy(),this.destroyAllLayers(),l(this)},p.prototype.hotspotContainer=function(){return this._hotspotContainer},p.prototype.layer=function(){return this._layers[0]},p.prototype.listLayers=function(){return[].concat(this._layers)},p.prototype.view=function(){return this._view},p.prototype.viewer=function(){return this._viewer},p.prototype.visible=function(){return this._viewer.scene()===this},p.prototype.createLayer=function(t){var e=(t=t||{}).textureStoreOpts||{},n=t.layerOpts||{},o=t.source,s=t.geometry,a=this._view,u=this._viewer.stage(),h=new i(o,u,e),c=new r(o,s,a,h,n);return this._layers.push(c),t.pinFirstLevel&&c.pinFirstLevel(),this.emit("layerChange"),c},p.prototype.destroyLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error("No such layer in scene");this._layers.splice(e,1),this.emit("layerChange"),t.textureStore().destroy(),t.destroy()},p.prototype.destroyAllLayers=function(){for(;this._layers.length>0;)this.destroyLayer(this._layers[0])},p.prototype.switchTo=function(t,e){return this._viewer.switchScene(this,t,e)},p.prototype.lookTo=function(t,e,n){if(e=e||{},n=n||u,"object"!==h(t))throw new Error("Target view parameters must be an object");var r=null!=e.ease?e.ease:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},i=null!=e.controlsInterrupt&&e.controlsInterrupt,o=null!=e.transitionDuration?e.transitionDuration:1e3,s=null==e.shortest||e.shortest,a=this._view,l=a.parameters(),p={};c(p,t),c(p,l),s&&a.normalizeToClosest&&a.normalizeToClosest(p,p);var f=this._viewer.controls().enabled();i||this._viewer.controls().disable(),this.startMovement((function(){var t=!1;return function(e,n){if(n>=o&&t)return null;var i=Math.min(n/o,1);for(var s in e){var a=l[s],u=p[s];e[s]=a+r(i)*(u-a)}return t=n>=o,e}}),(function(){f&&this._viewer.controls().enable(),n()}))},p.prototype.startMovement=function(t,e){var n=this._viewer.renderLoop();this._movement&&this.stopMovement();var r=t();if("function"!=typeof r)throw new Error("Bad movement");this._movement=t,this._movementStep=r,this._movementStartTime=a(),this._movementParams={},this._movementCallback=e,n.addEventListener("beforeRender",this._updateMovementHandler),n.renderOnNextFrame()},p.prototype.stopMovement=function(){var t=this._viewer.renderLoop();this._movement&&(this._movementCallback&&this._movementCallback(),t.removeEventListener("beforeRender",this._updateMovementHandler),this._movement=null,this._movementStep=null,this._movementStartTime=null,this._movementParams=null,this._movementCallback=null)},p.prototype.movement=function(){return this._movement},p.prototype._updateMovement=function(){if(!this._movement)throw new Error("Should not call update");var t=this._viewer.renderLoop(),e=this._view,n=a()-this._movementStartTime,r=this._movementStep,i=this._movementParams;null==(i=r(i=e.parameters(i),n))?this.stopMovement():(e.setParameters(i),t.renderOnNextFrame())},p.prototype._updateHotspotContainer=function(){this.visible()?this._hotspotContainer.show():this._hotspotContainer.hide()},t.exports=p},7559:function(t,e,n){"use strict";var r=n(3180),i=n(5184),o=n(5290),s=n(5696),a=n(9821),u=n(2582),h=n(8111),c=n(5003),l=n(6112),p="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.textureStore,f={previouslyVisibleCacheSize:512},d=0;function m(){}function v(t,e){var n=this,r=d++;n._id=r,n._store=t,n._tile=e,n._asset=null,n._texture=null,n._changeHandler=function(){t.emit("textureInvalid",e)};var i=t.source(),o=t.stage(),s=i.loadAsset.bind(i),a=o.createTexture.bind(o),c=h(u(s),a);t.emit("textureStartLoad",e),p&&console.log("loading",r,e),n._cancel=c(o,e,(function(i,o,s,a){if(n._cancel=null,i)return s&&s.destroy(),a&&a.destroy(),void(i instanceof m?(t.emit("textureCancel",e),p&&console.log("cancel",r,e)):(t.emit("textureError",e,i),p&&console.log("error",r,e)));n._texture=a,s.isDynamic()?(n._asset=s,s.addEventListener("change",n._changeHandler)):s.destroy(),t.emit("textureLoad",e),p&&console.log("load",r,e)}))}function _(t,e,n){n=a(n||{},f),this._source=t,this._stage=e,this._state=0,this._delimCount=0,this._itemMap=new r,this._visible=new i,this._previouslyVisible=new o(n.previouslyVisibleCacheSize),this._pinMap=new r,this._newVisible=new i,this._noLongerVisible=[],this._visibleAgain=[],this._evicted=[]}c(m,Error),v.prototype.asset=function(){return this._asset},v.prototype.texture=function(){return this._texture},v.prototype.destroy=function(){var t=this._id,e=this._store,n=this._tile,r=this._asset,i=this._texture,o=this._cancel;o?o(new m("Texture load cancelled")):(r&&(r.removeEventListener("change",this._changeHandler),r.destroy()),i&&i.destroy(),e.emit("textureUnload",n),p&&console.log("unload",t,n),l(this))},s(v),s(_),_.prototype.destroy=function(){this.clear(),l(this)},_.prototype.stage=function(){return this._stage},_.prototype.source=function(){return this._source},_.prototype.clear=function(){var t=this;t._evicted.length=0,t._itemMap.forEach((function(e){t._evicted.push(e)})),t._evicted.forEach((function(e){t._unloadTile(e)})),t._itemMap.clear(),t._visible.clear(),t._previouslyVisible.clear(),t._pinMap.clear(),t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},_.prototype.clearNotPinned=function(){var t=this;t._evicted.length=0,t._itemMap.forEach((function(e){t._pinMap.has(e)||t._evicted.push(e)})),t._evicted.forEach((function(e){t._unloadTile(e)})),t._visible.clear(),t._previouslyVisible.clear(),t._evicted.length=0},_.prototype.startFrame=function(){if(0!==this._state&&1!==this._state)throw new Error("TextureStore: startFrame called out of sequence");this._state=1,this._delimCount++},_.prototype.markTile=function(t){if(1!==this._state&&2!==this._state)throw new Error("TextureStore: markTile called out of sequence");this._state=2;var e=this._itemMap.get(t),n=e&&e.texture(),r=e&&e.asset();n&&r&&n.refresh(t,r),this._newVisible.add(t)},_.prototype.endFrame=function(){if(1!==this._state&&2!==this._state&&3!==this._state)throw new Error("TextureStore: endFrame called out of sequence");this._state=3,this._delimCount--,this._delimCount||(this._update(),this._state=0)},_.prototype._update=function(){var t=this;t._noLongerVisible.length=0,t._visible.forEach((function(e){t._newVisible.has(e)||t._noLongerVisible.push(e)})),t._visibleAgain.length=0,t._newVisible.forEach((function(e){t._previouslyVisible.has(e)&&t._visibleAgain.push(e)})),t._visibleAgain.forEach((function(e){t._previouslyVisible.remove(e)})),t._evicted.length=0,t._noLongerVisible.forEach((function(e){var n=t._itemMap.get(e);if(n&&n.texture()){var r=t._previouslyVisible.add(e);null!=r&&t._evicted.push(r)}else n&&t._unloadTile(e)})),t._evicted.forEach((function(e){t._pinMap.has(e)||t._unloadTile(e)})),t._newVisible.forEach((function(e){t._itemMap.get(e)||t._loadTile(e)}));var e=t._visible;t._visible=t._newVisible,t._newVisible=e,t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},_.prototype._loadTile=function(t){if(this._itemMap.has(t))throw new Error("TextureStore: loading texture already in cache");var e=new v(this,t);this._itemMap.set(t,e)},_.prototype._unloadTile=function(t){var e=this._itemMap.del(t);if(!e)throw new Error("TextureStore: unloading texture not in cache");e.destroy()},_.prototype.asset=function(t){var e=this._itemMap.get(t);return e?e.asset():null},_.prototype.texture=function(t){var e=this._itemMap.get(t);return e?e.texture():null},_.prototype.pin=function(t){var e=(this._pinMap.get(t)||0)+1;return this._pinMap.set(t,e),this._itemMap.has(t)||this._loadTile(t),e},_.prototype.unpin=function(t){var e=this._pinMap.get(t);if(!e)throw new Error("TextureStore: unpin when not pinned");return--e>0?this._pinMap.set(t,e):(this._pinMap.del(t),this._visible.has(t)||this._previouslyVisible.has(t)||this._unloadTile(t)),e},_.prototype.query=function(t){var e=this._itemMap.get(t),n=this._pinMap.get(t)||0;return{visible:this._visible.has(t),previouslyVisible:this._previouslyVisible.has(t),hasAsset:null!=e&&null!=e.asset(),hasTexture:null!=e&&null!=e.texture(),pinned:0!==n,pinCount:n}},t.exports=_},6085:function(t,e,n){"use strict";var r=n(5184);function i(){this._stack=[],this._visited=new r,this._vertices=null}i.prototype.search=function(t,e,n){var r=this._stack,i=this._visited,o=this._vertices,s=0;for(this._clear(),r.push(e);r.length>0;){var a=r.pop();if(!i.has(a)&&t.intersects(a.vertices(o))){i.add(a);for(var u=a.neighbors(),h=0;h<u.length;h++)r.push(u[h]);n.push(a),s++}}return this._vertices=o,this._clear(),s},i.prototype._clear=function(){this._stack.length=0,this._visited.clear()},t.exports=i},9274:function(t,e,n){"use strict";var r=n(5696),i=n(9821),o=n(1227),s={duration:1/0};function a(t){t=i(t||{},s),this._duration=t.duration,this._startTime=null,this._handle=null,this._check=this._check.bind(this)}r(a),a.prototype.start=function(){this._startTime=o(),null==this._handle&&this._duration<1/0&&this._setup(this._duration)},a.prototype.started=function(){return null!=this._startTime},a.prototype.stop=function(){this._startTime=null,null!=this._handle&&(clearTimeout(this._handle),this._handle=null)},a.prototype._setup=function(t){this._handle=setTimeout(this._check,t)},a.prototype._teardown=function(){clearTimeout(this._handle),this._handle=null},a.prototype._check=function(){var t=o()-this._startTime,e=this._duration-t;this._teardown(),e<=0?(this.emit("timeout"),this._startTime=null):e<1/0&&this._setup(e)},a.prototype.duration=function(){return this._duration},a.prototype.setDuration=function(t){this._duration=t,null!=this._startTime&&this._check()},t.exports=a},7599:function(t,e,n){"use strict";var r=n(2060),i=n(5696),o=n(3036),s=n(1839),a=n(5214),u=n(9274),h=n(5662),c=n(2569),l=n(8975),p=n(7895),f=n(1505),d=n(6939).setOverflowHidden,m=n(6939).setAbsolute,v=n(6939).setFullSize,_=n(6939).setBlocking,y=n(5026),g=n(3120),w=n(6112);function M(t,e){e=e||{},this._domElement=t,d(t),this._stage=new h(e.stage),f(this._stage),this._domElement.appendChild(this._stage.domElement()),this._controlContainer=document.createElement("div"),m(this._controlContainer),v(this._controlContainer),r.ios&&this._controlContainer.addEventListener("touchmove",(function(t){t.preventDefault()}));var n=document.createElement("div");m(n),v(n),_(n),this._controlContainer.appendChild(n),t.appendChild(this._controlContainer),this._size={},this.updateSize(),this._updateSizeListener=this.updateSize.bind(this),window.addEventListener("resize",this._updateSizeListener),this._renderLoop=new o(this._stage),this._controls=new s,this._controlMethods=p(this._controls,this._controlContainer,e.controls),this._controls.attach(this._renderLoop),this._hammerManagerTouch=l.get(this._controlContainer,"touch"),this._hammerManagerMouse=l.get(this._controlContainer,"mouse"),this._dragCursor=new c(this._controls,"mouseViewDrag",t,e.cursors&&e.cursors.drag||{}),this._renderLoop.start(),this._scenes=[],this._currentScene=null,this._replacedScene=null,this._cancelCurrentTween=null,this._layerChangeHandler=this._updateSceneLayers.bind(this),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._idleTimer=new u,this._idleTimer.start(),this._resetIdleTimerHandler=this._resetIdleTimer.bind(this),this.addEventListener("viewChange",this._resetIdleTimerHandler),this._triggerIdleTimerHandler=this._triggerIdleTimer.bind(this),this._idleTimer.addEventListener("timeout",this._triggerIdleTimerHandler),this._stopMovementHandler=this.stopMovement.bind(this),this._controls.addEventListener("active",this._stopMovementHandler),this.addEventListener("sceneChange",this._stopMovementHandler),this._idleMovement=null}function b(t,e,n){e.listLayers().forEach((function(e){e.mergeEffects({opacity:t})})),e._hotspotContainer.domElement().style.opacity=t}i(M),M.prototype.destroy=function(){for(var t in window.removeEventListener("resize",this._updateSizeListener),this._currentScene&&this._removeSceneEventListeners(this._currentScene),this._replacedScene&&this._removeSceneEventListeners(this._replacedScene),this._dragCursor.destroy(),this._controlMethods)this._controlMethods[t].destroy();for(;this._scenes.length;)this.destroyScene(this._scenes[0]);this._domElement.removeChild(this._stage.domElement()),this._stage.destroy(),this._renderLoop.destroy(),this._controls.destroy(),this._controls=null,this._cancelCurrentTween&&this._cancelCurrentTween(),w(this)},M.prototype.updateSize=function(){var t=this._size;t.width=this._domElement.clientWidth,t.height=this._domElement.clientHeight,this._stage.setSize(t)},M.prototype.stage=function(){return this._stage},M.prototype.renderLoop=function(){return this._renderLoop},M.prototype.controls=function(){return this._controls},M.prototype.domElement=function(){return this._domElement},M.prototype.createScene=function(t){t=t||{};var e=this.createEmptyScene({view:t.view});return e.createLayer({source:t.source,geometry:t.geometry,pinFirstLevel:t.pinFirstLevel,textureStoreOpts:t.textureStoreOpts,layerOpts:t.layerOpts}),e},M.prototype.createEmptyScene=function(t){var e=new a(this,(t=t||{}).view);return this._scenes.push(e),e},M.prototype._updateSceneLayers=function(){var t,e,n=this._stage,r=this._currentScene,i=this._replacedScene,o=n.listLayers(),s=[];if(i&&(s=s.concat(i.listLayers())),r&&(s=s.concat(r.listLayers())),1!==Math.abs(o.length-s.length))throw new Error("Stage and scene out of sync");if(s.length<o.length)for(t=0;t<o.length;t++)if(e=o[t],s.indexOf(e)<0){this._removeLayerFromStage(e);break}if(s.length>o.length)for(t=0;t<s.length;t++)e=s[t],o.indexOf(e)<0&&this._addLayerToStage(e,t)},M.prototype._addLayerToStage=function(t,e){t.pinFirstLevel(),this._stage.addLayer(t,e)},M.prototype._removeLayerFromStage=function(t){this._stage.removeLayer(t),t.unpinFirstLevel(),t.textureStore().clearNotPinned()},M.prototype._addSceneEventListeners=function(t){t.addEventListener("layerChange",this._layerChangeHandler),t.addEventListener("viewChange",this._viewChangeHandler)},M.prototype._removeSceneEventListeners=function(t){t.removeEventListener("layerChange",this._layerChangeHandler),t.removeEventListener("viewChange",this._viewChangeHandler)},M.prototype.destroyScene=function(t){var e,n,r=this._scenes.indexOf(t);if(r<0)throw new Error("No such scene in viewer");if(this._currentScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null),this._currentScene=null,this.emit("sceneChange")}if(this._replacedScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._replacedScene=null}this._scenes.splice(r,1),t.destroy()},M.prototype.destroyAllScenes=function(){for(;this._scenes.length>0;)this.destroyScene(this._scenes[0])},M.prototype.hasScene=function(t){return this._scenes.indexOf(t)>=0},M.prototype.listScenes=function(){return[].concat(this._scenes)},M.prototype.scene=function(){return this._currentScene},M.prototype.view=function(){var t=this._currentScene;return t?t.view():null},M.prototype.lookTo=function(t,e,n){var r=this._currentScene;r&&r.lookTo(t,e,n)},M.prototype.startMovement=function(t,e){var n=this._currentScene;n&&n.startMovement(t,e)},M.prototype.stopMovement=function(){var t=this._currentScene;t&&t.stopMovement()},M.prototype.movement=function(){var t=this._currentScene;if(t)return t.movement()},M.prototype.setIdleMovement=function(t,e){this._idleTimer.setDuration(t),this._idleMovement=e},M.prototype.breakIdleMovement=function(){this.stopMovement(),this._resetIdleTimer()},M.prototype._resetIdleTimer=function(){this._idleTimer.start()},M.prototype._triggerIdleTimer=function(){var t=this._idleMovement;t&&this.startMovement(t)},M.prototype.switchScene=function(t,e,n){var r=this;e=e||{},n=n||g;var i=this._stage,o=this._currentScene;if(o!==t){if(this._scenes.indexOf(t)<0)throw new Error("No such scene in viewer");this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null);var s=o?o.listLayers():[],a=t.listLayers(),u=i.listLayers();if(o&&(u.length!==s.length||u.length>1&&u[0]!=s[0]))throw new Error("Stage not in sync with viewer");for(var h=null!=e.transitionDuration?e.transitionDuration:1e3,c=null!=e.transitionUpdate?e.transitionUpdate:b,l=0;l<a.length;l++)this._addLayerToStage(a[l]);this._cancelCurrentTween=y(h,(function(e){c(e,t,o)}),(function(){if(r._replacedScene){r._removeSceneEventListeners(r._replacedScene),s=r._replacedScene.listLayers();for(var t=0;t<s.length;t++)r._removeLayerFromStage(s[t]);r._replacedScene=null}r._cancelCurrentTween=null,n()})),this._currentScene=t,this._replacedScene=o,this.emit("sceneChange"),this.emit("viewChange"),this._addSceneEventListeners(t)}else n()},t.exports=M},3909:function(t,e,n){"use strict";var r=n(3188),i=n(5003),o=n(5696),s=n(6112);function a(t){this.constructor.super_.call(this,t),this._timestamp=0}i(a,r),o(a),a.prototype.destroy=function(){s(this)},a.prototype.timestamp=function(){return this._timestamp},a.prototype.isDynamic=function(){return!0},a.prototype.markDirty=function(){this._timestamp++,this.emit("change")},t.exports=a},3188:function(t,e,n){"use strict";var r=n(5135),i=n(5696),o=n(6112),s={HTMLImageElement:["naturalWidth","naturalHeight"],HTMLCanvasElement:["width","height"],ImageBitmap:["width","height"]};function a(t){var e=!1;for(var n in s)if(r[n]&&t instanceof r[n]){e=!0,this._widthProp=s[n][0],this._heightProp=s[n][1];break}if(!e)throw new Error("Unsupported pixel source");this._element=t}i(a),a.prototype.destroy=function(){o(this)},a.prototype.element=function(){return this._element},a.prototype.width=function(){return this._element[this._widthProp]},a.prototype.height=function(){return this._element[this._heightProp]},a.prototype.timestamp=function(){return 0},a.prototype.isDynamic=function(){return!1},t.exports=a},4273:function(t,e,n){"use strict";var r=n(9821),i=.01,o={yawSpeed:.1,pitchSpeed:.1,fovSpeed:.1,yawAccel:i,pitchAccel:i,fovAccel:i,targetPitch:0,targetFov:null};t.exports=function(t){var e=(t=r(t||{},o)).yawSpeed,n=t.pitchSpeed,i=t.fovSpeed,s=t.yawAccel,a=t.pitchAccel,u=t.fovAccel,h=t.targetPitch,c=t.targetFov;return function(){var t,r,o,l,p=0,f=0,d=0,m=0,v=0,_=0,y=0;return function(g,w){if(t=(w-p)/1e3,v=Math.min(f+t*s,e),r=v*t,g.yaw=g.yaw+r,null!=h&&g.pitch!==h){var M=.5*d*d/a;_=Math.abs(h-g.pitch)>M?Math.min(d+t*a,n):Math.max(d-t*a,0),o=_*t,h<g.pitch&&(g.pitch=Math.max(h,g.pitch-o)),h>g.pitch&&(g.pitch=Math.min(h,g.pitch+o))}if(null!=c&&g.fov!==h){var b=.5*m*m/u;y=Math.abs(c-g.fov)>b?Math.min(m+t*u,i):Math.max(m-t*u,0),l=y*t,c<g.fov&&(g.fov=Math.max(c,g.fov-l)),c>g.fov&&(g.fov=Math.min(c,g.fov+l))}return p=w,f=v,d=_,m=y,g}}}},46:function(t,e,n){"use strict";var r=n(8001);function i(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new Error("LruMap: invalid capacity");this._capacity=t,this._keys=new Array(this._capacity),this._values=new Array(this._capacity),this._start=0,this._size=0}i.prototype._index=function(t){return r(this._start+t,this._capacity)},i.prototype.get=function(t){for(var e=0;e<this._size;e++){var n=this._keys[this._index(e)];if(t.equals(n))return this._values[this._index(e)]}return null},i.prototype.set=function(t,e){if(0===this._capacity)return t;this.del(t);var n=this._size===this._capacity?this._keys[this._index(0)]:null;return this._keys[this._index(this._size)]=t,this._values[this._index(this._size)]=e,this._size<this._capacity?this._size++:this._start=this._index(1),n},i.prototype.del=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)])){for(var n=this._values[this._index(e)],r=e;r<this._size-1;r++)this._keys[this._index(r)]=this._keys[this._index(r+1)],this._values[this._index(r)]=this._values[this._index(r+1)];return this._size--,n}return null},i.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)]))return!0;return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._start=0,this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._keys[this._index(n)],this._values[this._index(n)]),e+=1;return e},t.exports=i},5290:function(t,e,n){"use strict";var r=n(8001);function i(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new Error("LruSet: invalid capacity");this._capacity=t,this._elements=new Array(this._capacity),this._start=0,this._size=0}i.prototype._index=function(t){return r(this._start+t,this._capacity)},i.prototype.add=function(t){if(0===this._capacity)return t;this.remove(t);var e=this._size===this._capacity?this._elements[this._index(0)]:null;return this._elements[this._index(this._size)]=t,this._size<this._capacity?this._size++:this._start=this._index(1),e},i.prototype.remove=function(t){for(var e=0;e<this._size;e++){var n=this._elements[this._index(e)];if(t.equals(n)){for(var r=e;r<this._size-1;r++)this._elements[this._index(r)]=this._elements[this._index(r+1)];return this._size--,n}}return null},i.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._elements[this._index(e)]))return!0;return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._elements.length=0,this._start=0,this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._elements[this._index(n)]),e+=1;return e},t.exports=i},3180:function(t,e,n){"use strict";var r=n(8001);function i(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw new Error("Map: invalid capacity");this._capacity=t||64,this._keyBuckets=[],this._valBuckets=[];for(var e=0;e<this._capacity;e++)this._keyBuckets.push([]),this._valBuckets.push([]);this._size=0}i.prototype.get=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return this._valBuckets[e][i]}return null},i.prototype.set=function(t,e){for(var n=r(t.hash(),this._capacity),i=this._keyBuckets[n],o=this._valBuckets[n],s=0;s<i.length;s++){var a=i[s];if(t.equals(a)){var u=o[s];return i[s]=t,o[s]=e,u}}return i.push(t),o.push(e),this._size++,null},i.prototype.del=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=this._valBuckets[e],o=0;o<n.length;o++){var s=n[o];if(t.equals(s)){for(var a=i[o],u=o;u<n.length-1;u++)n[u]=n[u+1],i[u]=i[u+1];return n.length=n.length-1,i.length=i.length-1,this._size--,a}}return null},i.prototype.has=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return!0}return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._keyBuckets[t].length=0,this._valBuckets[t].length=0;this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var r=this._keyBuckets[n],i=this._valBuckets[n],o=0;o<r.length;o++)t(r[o],i[o]),e+=1;return e},t.exports=i},5184:function(t,e,n){"use strict";var r=n(8001);function i(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw new Error("Set: invalid capacity");this._capacity=this._capacity||64,this._buckets=[];for(var e=0;e<this._capacity;e++)this._buckets.push([]);this._size=0}i.prototype.add=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return n[i]=t,o}return n.push(t),this._size++,null},i.prototype.remove=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o)){for(var s=i;s<n.length-1;s++)n[s]=n[s+1];return n.length=n.length-1,this._size--,o}}return null},i.prototype.has=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return!0}return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._buckets[t].length=0;this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var r=this._buckets[n],i=0;i<r.length;i++)t(r[i]),e+=1;return e},t.exports=i},2604:function(t,e,n){"use strict";var r=n(8585),i=n(8001);function o(t){this._concurrency=t&&t.concurrency||1,this._paused=t&&!!t.paused||!1,this._pool=[];for(var e=0;e<this._concurrency;e++)this._pool.push(new r(t));this._next=0}o.prototype.length=function(){for(var t=0,e=0;e<this._pool.length;e++)t+=this._pool[e].length();return t},o.prototype.push=function(t,e){var n=this._next,r=this._pool[n].push(t,e);return this._next=i(this._next+1,this._concurrency),r},o.prototype.pause=function(){if(!this._paused){this._paused=!0;for(var t=0;t<this._concurrency;t++)this._pool[t].pause()}},o.prototype.resume=function(){if(this._paused){this._paused=!1;for(var t=0;t<this._concurrency;t++)this._pool[t].resume()}},t.exports=o},8585:function(t,e,n){"use strict";var r=n(1227);function i(t,e){this.fn=t,this.cb=e,this.cfn=null}function o(t){this._queue=[],this._delay=t&&t.delay||0,this._paused=t&&!!t.paused||!1,this._currentTask=null,this._lastFinished=null}o.prototype.length=function(){return this._queue.length},o.prototype.push=function(t,e){var n=new i(t,e),r=this._cancel.bind(this,n);return this._queue.push(n),this._next(),r},o.prototype.pause=function(){this._paused||(this._paused=!0)},o.prototype.resume=function(){this._paused&&(this._paused=!1,this._next())},o.prototype._start=function(t){if(this._currentTask)throw new Error("WorkQueue: called start while running task");this._currentTask=t;var e=this._finish.bind(this,t);if(t.cfn=t.fn(e),"function"!=typeof t.cfn)throw new Error("WorkQueue: function is not cancellable")},o.prototype._finish=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask!==t)throw new Error("WorkQueue: called finish on wrong task");t.cb.apply(null,e),this._currentTask=null,this._lastFinished=r(),this._next()},o.prototype._cancel=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask===t)t.cfn.apply(null,e);else{var n=this._queue.indexOf(t);n>=0&&(this._queue.splice(n,1),t.cb.apply(null,e))}},o.prototype._next=function(){if(!this._paused&&this._queue.length&&!this._currentTask){if(null!=this._lastFinished){var t=r()-this._lastFinished,e=this._delay-t;if(e>0)return void setTimeout(this._next.bind(this),e)}var n=this._queue.shift();this._start(n)}},t.exports=o},8842:function(t,e,n){"use strict";var r=n(887).vec4,i=n(887).mat4;function o(t,e,n){var i,o,s,a,u,h,c;i=n,o=t,s=e.colorMatrix,a=o[0],u=o[1],h=o[2],c=o[3],i[0]=s[0]*a+s[1]*u+s[2]*h+s[3]*c,i[1]=s[4]*a+s[5]*u+s[6]*h+s[7]*c,i[2]=s[8]*a+s[9]*u+s[10]*h+s[11]*c,i[3]=s[12]*a+s[13]*u+s[14]*h+s[15]*c,r.add(n,n,e.colorOffset)}var s=r.create();t.exports={identity:function(t){var e=t||{};return e.colorOffset=e.colorOffset||r.create(),e.colorMatrix=e.colorMatrix||i.create(),e},applyToPixel:o,applyToImageData:function(t,e){for(var n=t.width,i=t.height,a=t.data,u=0;u<n*i;u++)r.set(s,a[4*u+0]/255,a[4*u+1]/255,a[4*u+2]/255,a[4*u+3]/255),o(s,e,s),a[4*u+0]=255*s[0],a[4*u+1]=255*s[1],a[4*u+2]=255*s[2],a[4*u+3]=255*s[3]}}},6279:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(1227),s=n(6112);function a(t){t=t||{},this._methods=[],this._parameters=["x","y","axisScaledX","axisScaledY","zoom","yaw","pitch","roll"],this._now=t.nowForTesting||o,this._composedOffsets={},this._composeReturn={offsets:this._composedOffsets,changing:null}}r(a),a.prototype.add=function(t){if(!this.has(t)){var e={};this._parameters.forEach((function(t){e[t]={dynamics:new i,time:null}}));var n=this._updateDynamics.bind(this,e),r={instance:t,dynamics:e,parameterDynamicsHandler:n};t.addEventListener("parameterDynamics",n),this._methods.push(r)}},a.prototype.remove=function(t){var e=this._indexOfInstance(t);if(e>=0){var n=this._methods.splice(e,1)[0];n.instance.removeEventListener("parameterDynamics",n.parameterDynamicsHandler)}},a.prototype.has=function(t){return this._indexOfInstance(t)>=0},a.prototype._indexOfInstance=function(t){for(var e=0;e<this._methods.length;e++)if(this._methods[e].instance===t)return e;return-1},a.prototype.list=function(){for(var t=[],e=0;e<this._methods.length;e++)t.push(this._methods[e].instance);return t},a.prototype._updateDynamics=function(t,e,n){var r=t[e];if(!r)throw new Error("Unknown control parameter "+e);var i=this._now();r.dynamics.update(n,(i-r.time)/1e3),r.time=i,this.emit("change")},a.prototype._resetComposedOffsets=function(){for(var t=0;t<this._parameters.length;t++)this._composedOffsets[this._parameters[t]]=0},a.prototype.offsets=function(){var t,e=!1,n=this._now();this._resetComposedOffsets();for(var r=0;r<this._methods.length;r++)for(var i=this._methods[r].dynamics,o=0;o<this._parameters.length;o++){var s=i[t=this._parameters[o]],a=s.dynamics;null!=a.offset&&(this._composedOffsets[t]+=a.offset,a.offset=null);var u=(n-s.time)/1e3,h=a.offsetFromVelocity(u);h&&(this._composedOffsets[t]+=h);var c=a.velocityAfter(u);a.velocity=c,c&&(e=!0),s.time=n}return this._composeReturn.changing=e,this._composeReturn},a.prototype.destroy=function(){for(var t=this.list(),e=0;e<t.length;e++)this.remove(t[e]);s(this)},t.exports=a},2569:function(t,e,n){"use strict";var r=n(9821),i=n(6112),o={active:"move",inactive:"default",disabled:"default"};function s(t,e,n,i){i=r(i||{},o),this._element=n,this._controls=t,this._id=e,this._attached=!1,this._setActiveCursor=this._setCursor.bind(this,i.active),this._setInactiveCursor=this._setCursor.bind(this,i.inactive),this._setDisabledCursor=this._setCursor.bind(this,i.disabled),this._setOriginalCursor=this._setCursor.bind(this,this._element.style.cursor),this._updateAttachmentHandler=this._updateAttachment.bind(this),t.addEventListener("methodEnabled",this._updateAttachmentHandler),t.addEventListener("methodDisabled",this._updateAttachmentHandler),t.addEventListener("enabled",this._updateAttachmentHandler),t.addEventListener("disabled",this._updateAttachmentHandler),this._updateAttachment()}s.prototype.destroy=function(){this._detachFromControlMethod(this._controls.method(this._id)),this._setOriginalCursor(),this._controls.removeEventListener("methodEnabled",this._updateAttachmentHandler),this._controls.removeEventListener("methodDisabled",this._updateAttachmentHandler),this._controls.removeEventListener("enabled",this._updateAttachmentHandler),this._controls.removeEventListener("disabled",this._updateAttachmentHandler),i(this)},s.prototype._updateAttachment=function(){var t=this._controls,e=this._id;t.enabled()&&t.method(e).enabled?this._attachToControlMethod(t.method(e)):this._detachFromControlMethod(t.method(e))},s.prototype._attachToControlMethod=function(t){this._attached||(t.instance.addEventListener("active",this._setActiveCursor),t.instance.addEventListener("inactive",this._setInactiveCursor),t.active?this._setActiveCursor():this._setInactiveCursor(),this._attached=!0)},s.prototype._detachFromControlMethod=function(t){this._attached&&(t.instance.removeEventListener("active",this._setActiveCursor),t.instance.removeEventListener("inactive",this._setInactiveCursor),this._setDisabledCursor(),this._attached=!1)},s.prototype._setCursor=function(t){this._element.style.cursor=t},t.exports=s},1839:function(t,e,n){"use strict";var r=n(5696),i=n(6279),o=n(6112),s="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function a(t){t=t||{},this._methods={},this._methodGroups={},this._composer=new i,this._enabled=!t||!t.enabled||!!t.enabled,this._activeCount=0,this.updatedViews_=[],this._attachedRenderLoop=null}r(a),a.prototype.destroy=function(){this.detach(),this._composer.destroy(),o(this)},a.prototype.methods=function(){var t={};for(var e in this._methods)t[e]=this._methods[e];return t},a.prototype.method=function(t){return this._methods[t]},a.prototype.registerMethod=function(t,e,n){if(this._methods[t])throw new Error("Control method already registered with id "+t);this._methods[t]={instance:e,enabled:!1,active:!1,activeHandler:this._handleActive.bind(this,t),inactiveHandler:this._handleInactive.bind(this,t)},n&&this.enableMethod(t,e)},a.prototype.unregisterMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled&&this.disableMethod(t),delete this._methods[t]},a.prototype.enableMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled||(e.enabled=!0,e.active&&this._incrementActiveCount(),this._listen(t),this._updateComposer(),this.emit("methodEnabled",t))},a.prototype.disableMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled&&(e.enabled=!1,e.active&&this._decrementActiveCount(),this._unlisten(t),this._updateComposer(),this.emit("methodDisabled",t))},a.prototype.addMethodGroup=function(t,e){this._methodGroups[t]=e},a.prototype.removeMethodGroup=function(t){delete this._methodGroups[t]},a.prototype.methodGroups=function(){var t={};for(var e in this._methodGroups)t[e]=this._methodGroups[e];return t},a.prototype.enableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach((function(t){e.enableMethod(t)}))},a.prototype.disableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach((function(t){e.disableMethod(t)}))},a.prototype.enabled=function(){return this._enabled},a.prototype.enable=function(){this._enabled||(this._enabled=!0,this._activeCount>0&&this.emit("active"),this.emit("enabled"),this._updateComposer())},a.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._activeCount>0&&this.emit("inactive"),this.emit("disabled"),this._updateComposer())},a.prototype.attach=function(t){this._attachedRenderLoop&&this.detach(),this._attachedRenderLoop=t,this._beforeRenderHandler=this._updateViewsWithControls.bind(this),this._changeHandler=t.renderOnNextFrame.bind(t),this._attachedRenderLoop.addEventListener("beforeRender",this._beforeRenderHandler),this._composer.addEventListener("change",this._changeHandler)},a.prototype.detach=function(){this._attachedRenderLoop&&(this._attachedRenderLoop.removeEventListener("beforeRender",this._beforeRenderHandler),this._composer.removeEventListener("change",this._changeHandler),this._beforeRenderHandler=null,this._changeHandler=null,this._attachedRenderLoop=null)},a.prototype.attached=function(){return null!=this._attachedRenderLoop},a.prototype._listen=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");e.instance.addEventListener("active",e.activeHandler),e.instance.addEventListener("inactive",e.inactiveHandler)},a.prototype._unlisten=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");e.instance.removeEventListener("active",e.activeHandler),e.instance.removeEventListener("inactive",e.inactiveHandler)},a.prototype._handleActive=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");if(!e.enabled)throw new Error("Should not receive event from disabled control method");e.active||(e.active=!0,this._incrementActiveCount())},a.prototype._handleInactive=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");if(!e.enabled)throw new Error("Should not receive event from disabled control method");e.active&&(e.active=!1,this._decrementActiveCount())},a.prototype._incrementActiveCount=function(){this._activeCount++,s&&this._checkActiveCount(),this._enabled&&1===this._activeCount&&this.emit("active")},a.prototype._decrementActiveCount=function(){this._activeCount--,s&&this._checkActiveCount(),this._enabled&&0===this._activeCount&&this.emit("inactive")},a.prototype._checkActiveCount=function(){var t=0;for(var e in this._methods){var n=this._methods[e];n.enabled&&n.active&&t++}if(t!=this._activeCount)throw new Error("Bad control state")},a.prototype._updateComposer=function(){var t=this._composer;for(var e in this._methods){var n=this._methods[e],r=this._enabled&&n.enabled;r&&!t.has(n.instance)&&t.add(n.instance),!r&&t.has(n.instance)&&t.remove(n.instance)}},a.prototype._updateViewsWithControls=function(){var t=this._composer.offsets();t.changing&&this._attachedRenderLoop.renderOnNextFrame(),this.updatedViews_.length=0;for(var e=this._attachedRenderLoop.stage().listLayers(),n=0;n<e.length;n++){var r=e[n].view();this.updatedViews_.indexOf(r)<0&&(e[n].view().updateWithControlParameters(t.offsets),this.updatedViews_.push(r))}},t.exports=a},9869:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(9821),a=n(958).maxFriction,u=n(6112),h={friction:6,maxFrictionTime:.3},c="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function l(t,e,n){this._element=t,this._opts=s(n||{},h),this._startEvent=null,this._lastEvent=null,this._active=!1,this._dynamics={x:new i,y:new i},this._hammer=o.get(t,e),this._hammer.on("hammer.input",this._handleHammerEvent.bind(this)),this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleEnd.bind(this)),this._hammer.on("pancancel",this._handleEnd.bind(this))}r(l),l.prototype.destroy=function(){this._hammer.release(),u(this)},l.prototype._handleHammerEvent=function(t){if(t.isFirst){if(c&&this._active)throw new Error("DragControlMethod active detected when already active");this._active=!0,this.emit("active")}if(t.isFinal){if(c&&!this._active)throw new Error("DragControlMethod inactive detected when already inactive");this._active=!1,this.emit("inactive")}},l.prototype._handleStart=function(t){t.preventDefault(),this._startEvent=t},l.prototype._handleMove=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsMove(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y))},l.prototype._handleEnd=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsRelease(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y)),this._startEvent=!1,this._lastEvent=!1},l.prototype._updateDynamicsMove=function(t){var e=t.deltaX,n=t.deltaY,r=this._lastEvent||this._startEvent;r&&(e-=r.deltaX,n-=r.deltaY);var i=this._element.getBoundingClientRect();e/=i.right-i.left,n/=i.bottom-i.top,this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.offset=-e,this._dynamics.y.offset=-n,this._lastEvent=t};var p=[null,null];l.prototype._updateDynamicsRelease=function(t){var e=this._element.getBoundingClientRect(),n=e.right-e.left,r=e.bottom-e.top,i=1e3*t.velocityX/n,o=1e3*t.velocityY/r;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=i,this._dynamics.y.velocity=o,a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,p),this._dynamics.x.friction=p[0],this._dynamics.y.friction=p[1]},t.exports=l},4301:function(t){"use strict";function e(){this.velocity=null,this.friction=null,this.offset=null}e.equals=function(t,e){return t.velocity===e.velocity&&t.friction===e.friction&&t.offset===e.offset},e.prototype.equals=function(t){return e.equals(this,t)},e.prototype.update=function(t,e){t.offset&&(this.offset=this.offset||0,this.offset+=t.offset);var n=this.offsetFromVelocity(e);n&&(this.offset=this.offset||0,this.offset+=n),this.velocity=t.velocity,this.friction=t.friction},e.prototype.reset=function(){this.velocity=null,this.friction=null,this.offset=null},e.prototype.velocityAfter=function(t){return this.velocity?this.friction?(e=this.velocity,n=this.friction*t,e<0?Math.min(0,e+n):e>0?Math.max(0,e-n):0):this.velocity:null;var e,n},e.prototype.offsetFromVelocity=function(t){t=Math.min(t,this.nullVelocityTime());var e=this.velocityAfter(t);return(this.velocity+e)/2*t},e.prototype.nullVelocityTime=function(){return null==this.velocity?0:this.velocity&&!this.friction?1/0:Math.abs(this.velocity/this.friction)},t.exports=e},6067:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t,e,n,r){if(!t)throw new Error("ElementPressControlMethod: element must be defined");if(!e)throw new Error("ElementPressControlMethod: parameter must be defined");if(!n)throw new Error("ElementPressControlMethod: velocity must be defined");if(!r)throw new Error("ElementPressControlMethod: friction must be defined");this._element=t,this._pressHandler=this._handlePress.bind(this),this._releaseHandler=this._handleRelease.bind(this),t.addEventListener("mousedown",this._pressHandler),t.addEventListener("mouseup",this._releaseHandler),t.addEventListener("mouseleave",this._releaseHandler),t.addEventListener("touchstart",this._pressHandler),t.addEventListener("touchmove",this._releaseHandler),t.addEventListener("touchend",this._releaseHandler),this._parameter=e,this._velocity=n,this._friction=r,this._dynamics=new i,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("mousedown",this._pressHandler),this._element.removeEventListener("mouseup",this._releaseHandler),this._element.removeEventListener("mouseleave",this._releaseHandler),this._element.removeEventListener("touchstart",this._pressHandler),this._element.removeEventListener("touchmove",this._releaseHandler),this._element.removeEventListener("touchend",this._releaseHandler),o(this)},s.prototype._handlePress=function(){this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active")},s.prototype._handleRelease=function(){this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1},t.exports=s},8975:function(t,e,n){"use strict";var r=n(840),i=1,o="MarzipanoHammerElementId";function s(t,e){return t[o]||(t[o]=i++),e+t[o]}function a(){this._managers={},this._refCount={}}function u(t,e,n,r){this._manager=e,this._element=n,this._type=r,this._hammerGestures=t,this._eventHandlers=[]}a.prototype.get=function(t,e){var n=s(t,e);return this._managers[n]||(this._managers[n]=this._createManager(t,e),this._refCount[n]=0),this._refCount[n]++,new u(this,this._managers[n],t,e)},a.prototype._createManager=function(t,e){var n=new r.Manager(t);return"mouse"===e?n.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:0})):"touch"!==e&&"pen"!==e&&"kinect"!==e||(n.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:20,pointers:1})),n.add(new r.Pinch)),n},a.prototype._releaseHandle=function(t,e){var n=s(t,e);this._refCount[n]&&(this._refCount[n]--,this._refCount[n]||(this._managers[n].destroy(),delete this._managers[n],delete this._refCount[n]))},u.prototype.on=function(t,e){var n=this._type,r=function(t){n===t.pointerType&&e(t)};this._eventHandlers.push({events:t,handler:r}),this._manager.on(t,r)},u.prototype.release=function(){for(var t=0;t<this._eventHandlers.length;t++){var e=this._eventHandlers[t];this._manager.off(e.events,e.handler)}this._hammerGestures._releaseHandle(this._element,this._type),this._manager=null,this._element=null,this._type=null,this._hammerGestures=null},u.prototype.manager=function(){return this._manager},t.exports=new a},3939:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t,e,n,r,o){if(!t)throw new Error("KeyControlMethod: keyCode must be defined");if(!e)throw new Error("KeyControlMethod: parameter must be defined");if(!n)throw new Error("KeyControlMethod: velocity must be defined");if(!r)throw new Error("KeyControlMethod: friction must be defined");o=o||document,this._keyCode=t,this._parameter=e,this._velocity=n,this._friction=r,this._element=o,this._keydownHandler=this._handlePress.bind(this),this._keyupHandler=this._handleRelease.bind(this),this._blurHandler=this._handleBlur.bind(this),this._element.addEventListener("keydown",this._keydownHandler),this._element.addEventListener("keyup",this._keyupHandler),window.addEventListener("blur",this._blurHandler),this._dynamics=new i,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("keydown",this._keydownHandler),this._element.removeEventListener("keyup",this._keyupHandler),window.removeEventListener("blur",this._blurHandler),o(this)},s.prototype._handlePress=function(t){t.keyCode===this._keyCode&&(this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active"))},s.prototype._handleRelease=function(t){t.keyCode===this._keyCode&&(this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1)},s.prototype._handleBlur=function(){this._dynamics.velocity=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive"),this._pressing=!1},t.exports=s},425:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(6112);function a(t,e,n){this._hammer=o.get(t,e),this._lastEvent=null,this._active=!1,this._dynamics=new i,this._hammer.on("pinchstart",this._handleStart.bind(this)),this._hammer.on("pinch",this._handleEvent.bind(this)),this._hammer.on("pinchend",this._handleEnd.bind(this)),this._hammer.on("pinchcancel",this._handleEnd.bind(this))}r(a),a.prototype.destroy=function(){this._hammer.release(),s(this)},a.prototype._handleStart=function(){this._active||(this._active=!0,this.emit("active"))},a.prototype._handleEnd=function(){this._lastEvent=null,this._active&&(this._active=!1,this.emit("inactive"))},a.prototype._handleEvent=function(t){var e=t.scale;this._lastEvent&&(e/=this._lastEvent.scale),this._dynamics.offset=-1*(e-1),this.emit("parameterDynamics","zoom",this._dynamics),this._lastEvent=t},t.exports=a},9203:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(9821),a=n(958).maxFriction,u=n(6112),h={speed:8,friction:6,maxFrictionTime:.3};function c(t,e,n){this._element=t,this._opts=s(n||{},h),this._active=!1,this._hammer=o.get(t,e),this._dynamics={x:new i,y:new i},this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleRelease.bind(this)),this._hammer.on("pancancel",this._handleRelease.bind(this))}r(c),c.prototype.destroy=function(){this._hammer.release(),u(this)},c.prototype._handleStart=function(t){t.preventDefault(),this._active||(this._active=!0,this.emit("active"))},c.prototype._handleMove=function(t){t.preventDefault(),this._updateDynamics(t,!1)},c.prototype._handleRelease=function(t){t.preventDefault(),this._updateDynamics(t,!0),this._active&&(this._active=!1,this.emit("inactive"))};var l=[null,null];c.prototype._updateDynamics=function(t,e){var n=this._element.getBoundingClientRect(),r=n.right-n.left,i=n.bottom-n.top,o=Math.max(r,i),s=t.deltaX/o*this._opts.speed,u=t.deltaY/o*this._opts.speed;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=s,this._dynamics.y.velocity=u,e&&(a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,l),this._dynamics.x.friction=l[0],this._dynamics.y.friction=l[1]),this.emit("parameterDynamics","x",this._dynamics.x),this.emit("parameterDynamics","y",this._dynamics.y)},t.exports=c},9166:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(9821),s=n(6112),a={frictionTime:.2,zoomDelta:.001};function u(t,e){this._element=t,this._opts=o(e||{},a),this._dynamics=new i,this._eventList=[];var n=this._opts.frictionTime?this.withSmoothing:this.withoutSmoothing;this._wheelListener=n.bind(this),t.addEventListener("wheel",this._wheelListener)}function h(t){var e=1==t.deltaMode?20:1;return t.deltaY*e}r(u),u.prototype.destroy=function(){this._element.removeEventListener(this._wheelListener),s(this)},u.prototype.withoutSmoothing=function(t){this._dynamics.offset=h(t)*this._opts.zoomDelta,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},u.prototype.withSmoothing=function(t){var e=t.timeStamp;for(this._eventList.push(t);this._eventList[0].timeStamp<e-1e3*this._opts.frictionTime;)this._eventList.shift(0);for(var n=0,r=0;r<this._eventList.length;r++)n+=h(this._eventList[r])*this._opts.zoomDelta/this._opts.frictionTime;this._dynamics.velocity=n,this._dynamics.friction=Math.abs(n)/this._opts.frictionTime,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},t.exports=u},8255:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t){if(!t)throw new Error("VelocityControlMethod: parameter must be defined");this._parameter=t,this._dynamics=new i}r(s),s.prototype.destroy=function(){o(this)},s.prototype.setVelocity=function(t){this._dynamics.velocity=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},s.prototype.setFriction=function(t){this._dynamics.friction=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},t.exports=s},7895:function(t,e,n){"use strict";var r=n(9821),i=n(9869),o=n(9203),s=n(9166),a=n(425),u=n(3939),h={mouseViewMode:"drag"};t.exports=function(t,e,n){n=r(n||{},h);var c={mouseViewDrag:new i(e,"mouse"),mouseViewQtvr:new o(e,"mouse"),touchView:new i(e,"touch"),pinch:new a(e,"touch"),leftArrowKey:new u(37,"x",-.7,3),rightArrowKey:new u(39,"x",.7,3),upArrowKey:new u(38,"y",-.7,3),downArrowKey:new u(40,"y",.7,3),plusKey:new u(107,"zoom",-.7,3),minusKey:new u(109,"zoom",.7,3),wKey:new u(87,"y",-.7,3),aKey:new u(65,"x",-.7,3),sKey:new u(83,"y",.7,3),dKey:new u(68,"x",.7,3),qKey:new u(81,"roll",.7,3),eKey:new u(69,"roll",-.7,3)};!1!==n.scrollZoom&&(c.scrollZoom=new s(e));var l={arrowKeys:["leftArrowKey","rightArrowKey","upArrowKey","downArrowKey"],plusMinusKeys:["plusKey","minusKey"],wasdKeys:["wKey","aKey","sKey","dKey"],qeKeys:["qKey","eKey"]},p=["scrollZoom","touchView","pinch"];switch(n.mouseViewMode){case"drag":p.push("mouseViewDrag");break;case"qtvr":p.push("mouseViewQtvr");break;default:throw new Error("Unknown mouse view mode: "+n.mouseViewMode)}for(var f in c){var d=c[f];t.registerMethod(f,d),p.indexOf(f)>=0&&t.enableMethod(f)}for(var m in l){var v=l[m];t.addMethodGroup(m,v)}return c}},958:function(t){"use strict";function e(t,e,n,r){var i=Math.atan(e/t);r[0]=n*Math.cos(i),r[1]=n*Math.sin(i)}t.exports={maxFriction:function(t,n,r,i,o){var s=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));e(n,r,t=Math.max(t,s/i),o),o[0]=Math.abs(o[0]),o[1]=Math.abs(o[1])},changeVectorNorm:e}},9032:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(6085),s=n(46),a=n(2467),u=n(6762).makeLevelList,h=n(6762).makeSelectableLevelList,c=n(5342),l=n(7784),p=n(3969),f=n(887).vec3,d=n(887).vec4,m="fudlrb",v={f:{x:0,y:0},b:{x:0,y:Math.PI},l:{x:0,y:Math.PI/2},r:{x:0,y:-Math.PI/2},u:{x:Math.PI/2,y:0},d:{x:-Math.PI/2,y:0}},_=f.create();function y(t,e,n,r){e&&f.rotateZ(t,t,_,e),n&&f.rotateX(t,t,_,n),r&&f.rotateY(t,t,_,r)}for(var g={},w=0;w<m.length;w++){var M=m[w],b=v[M],x=f.fromValues(0,0,-1);y(x,0,b.x,b.y),g[M]=x}var E={f:["l","r","u","d"],b:["r","l","u","d"],l:["b","f","u","d"],r:["f","b","u","d"],u:["l","r","b","f"],d:["l","r","f","b"]},T=[[0,1],[1,0],[0,-1],[-1,0]];function L(t,e,n,r,i){this.face=t,this.x=e,this.y=n,this.z=r,this._geometry=i,this._level=i.levelList[r]}function C(t){if(this.constructor.super_.call(this,t),this._size=t.size,this._tileSize=t.tileSize,this._size%this._tileSize!=0)throw new Error("Level size is not multiple of tile size: "+this._size+" "+this._tileSize)}function S(t){if("array"!==p(t))throw new Error("Level list must be an array");this.levelList=u(t,C),this.selectableLevelList=h(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new o(this),this._neighborsCache=new s(64),this._vec=d.create(),this._viewSize={}}L.prototype.rotX=function(){return v[this.face].x},L.prototype.rotY=function(){return v[this.face].y},L.prototype.centerX=function(){return(this.x+.5)/this._level.numHorizontalTiles()-.5},L.prototype.centerY=function(){return.5-(this.y+.5)/this._level.numVerticalTiles()},L.prototype.scaleX=function(){return 1/this._level.numHorizontalTiles()},L.prototype.scaleY=function(){return 1/this._level.numVerticalTiles()},L.prototype.vertices=function(t){t||(t=[f.create(),f.create(),f.create(),f.create()]);var e=v[this.face];function n(t,n,r){f.set(t,n,r,-.5),y(t,0,e.x,e.y)}var r=this.centerX()-this.scaleX()/2,i=this.centerX()+this.scaleX()/2,o=this.centerY()-this.scaleY()/2,s=this.centerY()+this.scaleY()/2;return n(t[0],r,s),n(t[1],i,s),n(t[2],i,o),n(t[3],r,o),t},L.prototype.parent=function(){if(0===this.z)return null;var t=this.face,e=this.z,n=this.x,r=this.y,i=this._geometry,o=i.levelList[e],s=i.levelList[e-1];return new L(t,Math.floor(n/o.numHorizontalTiles()*s.numHorizontalTiles()),Math.floor(r/o.numVerticalTiles()*s.numVerticalTiles()),e-1,i)},L.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this.face,n=this.z,r=this.x,i=this.y,o=this._geometry,s=o.levelList[n],a=o.levelList[n+1],u=a.numHorizontalTiles()/s.numHorizontalTiles(),h=a.numVerticalTiles()/s.numVerticalTiles();t=t||[];for(var c=0;c<u;c++)for(var l=0;l<h;l++){var p=u*r+c,f=h*i+l,d=n+1;t.push(new L(e,p,f,d,o))}return t},L.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var r=t._vec,i=this.face,o=this.x,s=this.y,a=this.z,u=this._level,h=u.numHorizontalTiles(),l=u.numVerticalTiles(),p=[],d=0;d<T.length;d++){var m=o+T[d][0],_=s+T[d][1],g=a,w=i;if(m<0||m>=h||_<0||_>=l){var M,b=this.centerX(),x=this.centerY();m<0?(f.set(r,-.5,x,-.5),w=E[i][0]):m>=h?(f.set(r,.5,x,-.5),w=E[i][1]):_<0?(f.set(r,b,.5,-.5),w=E[i][2]):_>=l&&(f.set(r,b,-.5,-.5),w=E[i][3]),y(r,0,(M=v[i]).x,M.y),y(r,0,-(M=v[w]).x,-M.y),m=c(Math.floor((.5+r[0])*h),0,h-1),_=c(Math.floor((.5-r[1])*l),0,l-1)}p.push(new L(w,m,_,g,t))}return e.set(this,p),p},L.prototype.hash=function(){return i(m.indexOf(this.face),this.z,this.y,this.x)},L.prototype.equals=function(t){return this._geometry===t._geometry&&this.face===t.face&&this.z===t.z&&this.y===t.y&&this.x===t.x},L.prototype.cmp=function(t){return l(this.z,t.z)||l(m.indexOf(this.face),m.indexOf(t.face))||l(this.y,t.y)||l(this.x,t.x)},L.prototype.str=function(){return"CubeTile("+tile.face+", "+tile.x+", "+tile.y+", "+tile.z+")"},r(C,a),C.prototype.width=function(){return this._size},C.prototype.height=function(){return this._size},C.prototype.tileWidth=function(){return this._tileSize},C.prototype.tileHeight=function(){return this._tileSize},C.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),r=this.tileWidth(),i=this.tileHeight(),o=this.numHorizontalTiles(),s=this.numVerticalTiles(),a=t.width(),u=t.height(),h=t.tileWidth(),c=t.tileHeight(),l=t.numHorizontalTiles(),p=t.numVerticalTiles();if(e%a!=0)throw new Error("Level width must be multiple of parent level: "+e+" vs. "+a);if(n%u!=0)throw new Error("Level height must be multiple of parent level: "+n+" vs. "+u);if(o%l!=0)throw new Error("Number of horizontal tiles must be multiple of parent level: "+o+" ("+e+"/"+r+") vs. "+l+" ("+a+"/"+h+")");if(s%p!=0)throw new Error("Number of vertical tiles must be multiple of parent level: "+s+" ("+n+"/"+i+") vs. "+p+" ("+u+"/"+c+")")},S.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},S.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,i=t.numVerticalTiles()-1;e=e||[];for(var o=0;o<m.length;o++)for(var s=m[o],a=0;a<=r;a++)for(var u=0;u<=i;u++)e.push(new L(s,a,u,n,this));return e},S.prototype._closestTile=function(t,e){var n=this._vec;d.set(n,0,0,1,1),d.transformMat4(n,n,t.inverseProjection());var r=1/0,i=null;for(var o in g){var s=g[o],a=1-f.dot(s,n);a<r&&(r=a,i=o)}for(var u=Math.max(Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2]))/.5,h=0;h<3;h++)n[h]=n[h]/u;var l=v[i];y(n,0,-l.x,-l.y);var p=this.levelList.indexOf(e),m=e.numHorizontalTiles(),_=e.numVerticalTiles();return new L(i,c(Math.floor((.5+n[0])*m),0,m-1),c(Math.floor((.5-n[1])*_),0,_-1),p,this)},S.prototype.visibleTiles=function(t,e,n){var r=this._viewSize,i=this._tileSearcher;if(n=n||[],t.size(r),0===r.width||0===r.height)return n;var o=this._closestTile(t,e);if(!i.search(t,o,n))throw new Error("Starting tile is not visible");return n},S.Tile=S.prototype.Tile=L,S.type=S.prototype.type="cube",L.type=L.prototype.type="cube",t.exports=S},8988:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(7784),s=n(6762),a=n(2467),u=n(3969);function h(t,e){this.z=t,this._geometry=e,this._level=e.levelList[t]}function c(t){this.constructor.super_.call(this,t),this._width=t.width}function l(t){if("array"!==u(t))throw new Error("Level list must be an array");this.levelList=s.makeLevelList(t,c),this.selectableLevelList=s.makeSelectableLevelList(this.levelList)}h.prototype.rotX=function(){return 0},h.prototype.rotY=function(){return 0},h.prototype.centerX=function(){return.5},h.prototype.centerY=function(){return.5},h.prototype.scaleX=function(){return 1},h.prototype.scaleY=function(){return 1},h.prototype.parent=function(){return 0===this.z?null:new h(this.z-1,this._geometry)},h.prototype.children=function(t){return this.z===this._geometry.levelList.length-1?null:((t=t||[]).push(new h(this.z+1,this._geometry)),t)},h.prototype.neighbors=function(){return[]},h.prototype.hash=function(){return i(this.z)},h.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z},h.prototype.cmp=function(t){return o(this.z,t.z)},h.prototype.str=function(){return"EquirectTile("+tile.z+")"},r(c,a),c.prototype.width=function(){return this._width},c.prototype.height=function(){return this._width/2},c.prototype.tileWidth=function(){return this._width},c.prototype.tileHeight=function(){return this._width/2},l.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},l.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t);return(e=e||[]).push(new h(n,this)),e},l.prototype.visibleTiles=function(t,e,n){var r=new h(this.levelList.indexOf(e),this);(n=n||[]).length=0,n.push(r)},l.Tile=l.prototype.Tile=h,l.type=l.prototype.type="equirect",h.type=h.prototype.type="equirect",t.exports=l},754:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(6085),s=n(46),a=n(2467),u=n(6762).makeLevelList,h=n(6762).makeSelectableLevelList,c=n(5342),l=n(8001),p=n(7784),f=n(3969),d=n(887).vec2,m=n(887).vec4,v=[[0,1],[1,0],[0,-1],[-1,0]];function _(t,e,n,r){this.x=t,this.y=e,this.z=n,this._geometry=r,this._level=r.levelList[n]}function y(t){this.constructor.super_.call(this,t),this._width=t.width,this._height=t.height,this._tileWidth=t.tileWidth,this._tileHeight=t.tileHeight}function g(t){if("array"!==f(t))throw new Error("Level list must be an array");this.levelList=u(t,y),this.selectableLevelList=h(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new o(this),this._neighborsCache=new s(64),this._vec=m.create(),this._viewSize={}}_.prototype.rotX=function(){return 0},_.prototype.rotY=function(){return 0},_.prototype.centerX=function(){var t=this._level.width(),e=this._level.tileWidth();return(this.x*e+.5*this.width())/t-.5},_.prototype.centerY=function(){var t=this._level.height(),e=this._level.tileHeight();return.5-(this.y*e+.5*this.height())/t},_.prototype.scaleX=function(){var t=this._level.width();return this.width()/t},_.prototype.scaleY=function(){var t=this._level.height();return this.height()/t},_.prototype.width=function(){var t=this._level.width(),e=this._level.tileWidth();return this.x===this._level.numHorizontalTiles()-1&&l(t,e)||e},_.prototype.height=function(){var t=this._level.height(),e=this._level.tileHeight();return this.y===this._level.numVerticalTiles()-1&&l(t,e)||e},_.prototype.levelWidth=function(){return this._level.width()},_.prototype.levelHeight=function(){return this._level.height()},_.prototype.vertices=function(t){t||(t=[d.create(),d.create(),d.create(),d.create()]);var e=this.centerX()-this.scaleX()/2,n=this.centerX()+this.scaleX()/2,r=this.centerY()-this.scaleY()/2,i=this.centerY()+this.scaleY()/2;return d.set(t[0],e,i),d.set(t[1],n,i),d.set(t[2],n,r),d.set(t[3],e,r),t},_.prototype.parent=function(){if(0===this.z)return null;var t=this._geometry,e=this.z-1;return new _(Math.floor(this.x/2),Math.floor(this.y/2),e,t)},_.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this._geometry,n=this.z+1;return(t=t||[]).push(new _(2*this.x,2*this.y,n,e)),t.push(new _(2*this.x,2*this.y+1,n,e)),t.push(new _(2*this.x+1,2*this.y,n,e)),t.push(new _(2*this.x+1,2*this.y+1,n,e)),t},_.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var r=this.x,i=this.y,o=this.z,s=this._level,a=s.numHorizontalTiles()-1,u=s.numVerticalTiles()-1,h=[],c=0;c<v.length;c++){var l=r+v[c][0],p=i+v[c][1],f=o;0<=l&&l<=a&&0<=p&&p<=u&&h.push(new _(l,p,f,t))}return e.set(this,h),h},_.prototype.hash=function(){return i(this.z,this.y,this.x)},_.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z&&this.y===t.y&&this.x===t.x},_.prototype.cmp=function(t){return p(this.z,t.z)||p(this.y,t.y)||p(this.x,t.x)},_.prototype.str=function(){return"FlatTile("+tile.x+", "+tile.y+", "+tile.z+")"},r(y,a),y.prototype.width=function(){return this._width},y.prototype.height=function(){return this._height},y.prototype.tileWidth=function(){return this._tileWidth},y.prototype.tileHeight=function(){return this._tileHeight},y.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),r=this.tileWidth(),i=this.tileHeight(),o=t.width(),s=t.height(),a=t.tileWidth(),u=t.tileHeight();return e%o!=0?new Error("Level width must be multiple of parent level: "+e+" vs. "+o):n%s!=0?new Error("Level height must be multiple of parent level: "+n+" vs. "+s):r%a!=0?new Error("Level tile width must be multiple of parent level: "+r+" vs. "+a):i%u!=0?new Error("Level tile height must be multiple of parent level: "+i+" vs. "+u):void 0},g.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},g.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,i=t.numVerticalTiles()-1;e||(e=[]);for(var o=0;o<=r;o++)for(var s=0;s<=i;s++)e.push(new _(o,s,n,this));return e},g.prototype._closestTile=function(t,e){var n=this._vec;m.set(n,0,0,1,1),m.transformMat4(n,n,t.inverseProjection());var r=.5+n[0],i=.5-n[1],o=this.levelList.indexOf(e),s=e.width(),a=e.height(),u=e.tileWidth(),h=e.tileHeight(),l=e.numHorizontalTiles(),p=e.numVerticalTiles();return new _(c(Math.floor(r*s/u),0,l-1),c(Math.floor(i*a/h),0,p-1),o,this)},g.prototype.visibleTiles=function(t,e,n){var r=this._viewSize,i=this._tileSearcher;if(n=n||[],t.size(r),0===r.width||0===r.height)return n;var o=this._closestTile(t,e);if(!i.search(t,o,n))throw new Error("Starting tile is not visible");return n},g.Tile=g.prototype.Tile=_,g.type=g.prototype.type="flat",_.type=_.prototype.type="flat",t.exports=g},2467:function(t){"use strict";function e(t){this._fallbackOnly=!!t.fallbackOnly}e.prototype.numHorizontalTiles=function(){return Math.ceil(this.width()/this.tileWidth())},e.prototype.numVerticalTiles=function(){return Math.ceil(this.height()/this.tileHeight())},e.prototype.fallbackOnly=function(){return this._fallbackOnly},t.exports=e},6762:function(t,e,n){"use strict";var r=n(7784);t.exports={makeLevelList:function(t,e){for(var n=[],i=0;i<t.length;i++)n.push(new e(t[i]));return n.sort((function(t,e){return r(t.width(),e.width())})),n},makeSelectableLevelList:function(t){for(var e=[],n=0;n<t.length;n++)t[n]._fallbackOnly||e.push(t[n]);if(!e.length)throw new Error("No selectable levels in list");return e}}},5982:function(t,e,n){"use strict";t.exports={WebGlStage:n(5662),WebGlCubeRenderer:n(4641),WebGlFlatRenderer:n(591),WebGlEquirectRenderer:n(9999),registerDefaultRenderers:n(1505),CubeGeometry:n(9032),FlatGeometry:n(754),EquirectGeometry:n(8988),RectilinearView:n(3070),FlatView:n(8793),ImageUrlSource:n(6105),SingleAssetSource:n(541),StaticAsset:n(3188),DynamicAsset:n(3909),TextureStore:n(7559),Layer:n(4221),RenderLoop:n(3036),KeyControlMethod:n(3939),DragControlMethod:n(9869),QtvrControlMethod:n(9203),ScrollZoomControlMethod:n(9166),PinchZoomControlMethod:n(425),VelocityControlMethod:n(8255),ElementPressControlMethod:n(6067),Controls:n(1839),Dynamics:n(4301),Viewer:n(7599),Scene:n(5214),Hotspot:n(1154),HotspotContainer:n(3561),colorEffects:n(8842),registerDefaultControls:n(7895),autorotate:n(4273),util:{async:n(8667),cancelize:n(610),chain:n(8111),clamp:n(5342),clearOwnProperties:n(6112),cmp:n(7784),compose:n(6414),convertFov:n(1745),decimal:n(4743),defaults:n(9821),defer:n(3522),degToRad:n(6389),delay:n(9300),dom:n(6939),extend:n(8804),hash:n(6056),inherits:n(5003),mod:n(8001),noop:n(3120),now:n(1227),once:n(827),pixelRatio:n(2468),radToDeg:n(910),real:n(6467),retry:n(2582),tween:n(5026),type:n(3969)},dependencies:{bowser:n(2060),glMatrix:n(887),eventEmitter:n(5696),hammerjs:n(840)}}},1317:function(t,e,n){"use strict";var r=n(3188),i=n(3344),o=n(5135),s=n(827),a={imageOrientation:"flipY",premultiplyAlpha:"premultiply",resizeQuality:"high"};function u(t){this._stage=t}u.prototype.loadImage=function(t,e,n){var r=this,i=new Image;i.crossOrigin="anonymous";var o=e&&e.x||0,a=e&&e.y||0,u=e&&e.width||1,h=e&&e.height||1;return n=s(n),i.onload=function(){r._handleLoad(i,o,a,u,h,n)},i.onerror=function(){r._handleError(t,n)},i.src=t,function(){i.onload=i.onerror=null,i.src="",n.apply(null,arguments)}},u.prototype._handleLoad=function(t,e,n,i,s,u){if(0!==e||0!==n||1!==i||1!==s)if(e*=t.naturalWidth,n*=t.naturalHeight,i*=t.naturalWidth,s*=t.naturalHeight,o.createImageBitmap)o.createImageBitmap(t,e,n,i,s,a).then((function(t){u(null,new r(t))}));else{var h=document.createElement("canvas");h.width=i,h.height=s,h.getContext("2d").drawImage(t,e,n,i,s,0,0,i,s),u(null,new r(h))}else u(null,new r(t))},u.prototype._handleError=function(t,e){e(new i("Network error: "+t))},t.exports=u},4586:function(t,e,n){"use strict";var r=n(887).mat4,i=n(887).vec3,o=n(6112),s=n(8074),a=s.createConstantBuffers,u=s.destroyConstantBuffers,h=s.createShaderProgram,c=s.destroyShaderProgram,l=s.enableAttributes,p=s.disableAttributes,f=s.setViewport,d=s.setupPixelEffectUniforms,m=s.setDepth,v=s.setTexture,_=n(3846),y=n(2827),g=[0,1,2,0,2,3],w=[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],M=[0,0,1,0,1,1,0,1],b=["aVertexPosition","aTextureCoord"],x=["uDepth","uOpacity","uSampler","uProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix"];function E(t){this.gl=t,this.projMatrix=r.create(),this.viewportMatrix=r.create(),this.translateVector=i.create(),this.scaleVector=i.create(),this.constantBuffers=a(t,g,w,M),this.shaderProgram=h(t,_,y,b,x)}E.prototype.destroy=function(){u(this.gl,this.constantBuffers),c(this.gl,this.shaderProgram),o(this)},E.prototype.startLayer=function(t,e){var n=this.gl,r=this.shaderProgram,i=this.constantBuffers,o=this.viewportMatrix;n.useProgram(r),l(n,r),f(n,t,e,o),n.uniformMatrix4fv(r.uViewportMatrix,!1,o),n.bindBuffer(n.ARRAY_BUFFER,i.vertexPositions),n.vertexAttribPointer(r.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,i.textureCoords),n.vertexAttribPointer(r.aTextureCoord,2,n.FLOAT,n.FALSE,0,0),d(n,t.effects(),{opacity:r.uOpacity,colorOffset:r.uColorOffset,colorMatrix:r.uColorMatrix})},E.prototype.endLayer=function(t,e){var n=this.gl,r=this.shaderProgram;p(n,r)},E.prototype.renderTile=function(t,e,n,i){var o=this.gl,s=this.shaderProgram,a=this.constantBuffers,u=this.projMatrix,h=this.translateVector,c=this.scaleVector;h[0]=t.centerX(),h[1]=t.centerY(),h[2]=-.5,c[0]=t.scaleX(),c[1]=t.scaleY(),c[2]=1,r.copy(u,n.view().projection()),r.rotateX(u,u,t.rotX()),r.rotateY(u,u,t.rotY()),r.translate(u,u,h),r.scale(u,u,c),o.uniformMatrix4fv(s.uProjMatrix,!1,u),m(o,s,i,t.z),v(o,s,e),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,a.vertexIndices),o.drawElements(o.TRIANGLES,g.length,o.UNSIGNED_SHORT,0)},t.exports=E},8074:function(t,e,n){"use strict";var r=n(5342),i=n(887).vec4,o=n(887).vec3,s=n(887).mat4;function a(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw t.getShaderInfoLog(r);return r}function u(t,e,n,r){var i=t.createBuffer();return t.bindBuffer(e,i),t.bufferData(e,r,n),i}var h=i.create(),c=s.create();s.identity(c);var l=o.create(),p=o.create();t.exports={createShaderProgram:function(t,e,n,r,i){var o=a(t,t.VERTEX_SHADER,e),s=a(t,t.FRAGMENT_SHADER,n),u=t.createProgram();if(t.attachShader(u,o),t.attachShader(u,s),t.linkProgram(u),!t.getProgramParameter(u,t.LINK_STATUS))throw t.getProgramInfoLog(u);for(var h=0;h<r.length;h++){var c=r[h];if(u[c]=t.getAttribLocation(u,c),-1===u[c])throw new Error("Shader program has no "+c+" attribute")}for(var l=0;l<i.length;l++){var p=i[l];if(u[p]=t.getUniformLocation(u,p),-1===u[p])throw new Error("Shader program has no "+p+" uniform")}return u},destroyShaderProgram:function(t,e){for(var n=t.getAttachedShaders(e),r=0;r<n.length;r++){var i=n[r];t.detachShader(e,i),t.deleteShader(i)}t.deleteProgram(e)},createConstantBuffers:function(t,e,n,r){return{vertexIndices:u(t,t.ELEMENT_ARRAY_BUFFER,t.STATIC_DRAW,new Uint16Array(e)),vertexPositions:u(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(n)),textureCoords:u(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(r))}},destroyConstantBuffers:function(t,e){t.deleteBuffer(e.vertexIndices),t.deleteBuffer(e.vertexPositions),t.deleteBuffer(e.textureCoords)},enableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++)t.enableVertexAttribArray(r)},disableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++)t.disableVertexAttribArray(r)},setTexture:function(t,e,n){t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n._texture),t.uniform1i(e.uSampler,0)},setDepth:function(t,e,n,r){var i=(256*(n+1)-r)/65536;t.uniform1f(e.uDepth,i)},setViewport:function(t,e,n,i){if(0===n.x&&1===n.width&&0===n.y&&1===n.height)return t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),void s.identity(i);var a=n.x,u=r(a,0,1),h=u-a,c=1-u,f=r(n.width-h,0,c),d=n.width-f,m=1-n.height-n.y,v=r(m,0,1),_=v-m,y=1-v,g=r(n.height-_,0,y),w=n.height-g;o.set(p,n.width/f,n.height/g,1),o.set(l,(d-h)/f,(w-_)/g,0),s.identity(i),s.translate(i,i,l),s.scale(i,i,p),t.viewport(t.drawingBufferWidth*u,t.drawingBufferHeight*v,t.drawingBufferWidth*f,t.drawingBufferHeight*g)},setupPixelEffectUniforms:function(t,e,n){var r=1;e&&null!=e.opacity&&(r=e.opacity),t.uniform1f(n.opacity,r);var i=h;e&&e.colorOffset&&(i=e.colorOffset),t.uniform4fv(n.colorOffset,i);var o=c;e&&e.colorMatrix&&(o=e.colorMatrix),t.uniformMatrix4fv(n.colorMatrix,!1,o)}}},4641:function(t,e,n){"use strict";var r=n(4586);function i(){this.constructor.super_.apply(this,arguments)}n(5003)(i,r),t.exports=i},9999:function(t,e,n){"use strict";var r=n(887).mat4,i=n(6112),o=n(8074),s=o.createConstantBuffers,a=o.destroyConstantBuffers,u=o.createShaderProgram,h=o.destroyShaderProgram,c=o.enableAttributes,l=o.disableAttributes,p=o.setViewport,f=o.setupPixelEffectUniforms,d=o.setDepth,m=o.setTexture,v=n(453),_=n(8738),y=[0,1,2,0,2,3],g=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],w=[0,0,1,0,1,1,0,1],M=["aVertexPosition"],b=["uDepth","uOpacity","uSampler","uInvProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix","uTextureX","uTextureY","uTextureWidth","uTextureHeight"];function x(t){this.gl=t,this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.constantBuffers=s(t,y,g,w),this.shaderProgram=u(t,v,_,M,b)}x.prototype.destroy=function(){a(this.gl,this.constantBuffers),h(this.gl,this.shaderProgram),i(this)},x.prototype.startLayer=function(t,e){var n=this.gl,i=this.shaderProgram,o=this.constantBuffers,s=this.invProjMatrix,a=this.viewportMatrix;n.useProgram(i),c(n,i),p(n,t,e,a),n.uniformMatrix4fv(i.uViewportMatrix,!1,a),n.bindBuffer(n.ARRAY_BUFFER,o.vertexPositions),n.vertexAttribPointer(i.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,o.textureCoords),r.copy(s,t.view().projection()),r.invert(s,s),n.uniformMatrix4fv(i.uInvProjMatrix,!1,s);var u=t.effects().textureCrop||{},h=null!=u.x?u.x:0,l=null!=u.y?u.y:0,d=null!=u.width?u.width:1,m=null!=u.height?u.height:1;n.uniform1f(i.uTextureX,h),n.uniform1f(i.uTextureY,l),n.uniform1f(i.uTextureWidth,d),n.uniform1f(i.uTextureHeight,m),f(n,t.effects(),{opacity:i.uOpacity,colorOffset:i.uColorOffset,colorMatrix:i.uColorMatrix})},x.prototype.endLayer=function(t,e){var n=this.gl,r=this.shaderProgram;l(n,r)},x.prototype.renderTile=function(t,e,n,r){var i=this.gl,o=this.shaderProgram,s=this.constantBuffers;d(i,o,r,t.z),m(i,o,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s.vertexIndices),i.drawElements(i.TRIANGLES,y.length,i.UNSIGNED_SHORT,0)},t.exports=x},591:function(t,e,n){"use strict";var r=n(4586);function i(){this.constructor.super_.apply(this,arguments)}n(5003)(i,r),t.exports=i},1505:function(t,e,n){"use strict";var r=n(4641),i=n(591),o=n(9999);t.exports=function(t){switch(t.type){case"webgl":t.registerRenderer("flat","flat",i),t.registerRenderer("cube","rectilinear",r),t.registerRenderer("equirect","rectilinear",o);break;default:throw new Error("Unknown stage type: "+t.type)}}},8738:function(t){"use strict";t.exports=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform float uTextureX;","uniform float uTextureY;","uniform float uTextureWidth;","uniform float uTextureHeight;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec4 vRay;","const float PI = 3.14159265358979323846264;","void main(void) {","  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);","  float phi  = acos(vRay.y * r);","  float theta = atan(vRay.x, -1.0*vRay.z);","  float s = 0.5 + 0.5 * theta / PI;","  float t = 1.0 - phi / PI;","  s = s * uTextureWidth + uTextureX;","  t = t * uTextureHeight + uTextureY;","  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join("\n")},2827:function(t){"use strict";t.exports=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec2 vTextureCoord;","void main(void) {","  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join("\n")},453:function(t){"use strict";t.exports=["attribute vec3 aVertexPosition;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uInvProjMatrix;","varying vec4 vRay;","void main(void) {","  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);","  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);","}"].join("\n")},3846:function(t){"use strict";t.exports=["attribute vec3 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uProjMatrix;","varying vec2 vTextureCoord;","void main(void) {","  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);","  gl_Position.z = uDepth * gl_Position.w;","  vTextureCoord = aTextureCoord;","}"].join("\n")},6105:function(t,e,n){"use strict";var r=n(5696),i=n(3344),o=n(2604),s=n(8111),a=n(9300),u=n(1227),h={x:"x",y:"y",z:"z",f:"face"};function c(t,e){e=e||{},this._loadPool=new o({concurrency:e.concurrency||4}),this._retryDelay=e.retryDelay||1e4,this._retryMap={},this._sourceFromTile=t}function l(t){return new RegExp("\\{("+t+")\\}","g")}r(c),c.prototype.loadAsset=function(t,e,n){var r,o=this,h=this._retryDelay,c=this._retryMap,l=this._sourceFromTile(e),p=l.url,f=l.rect,d=t.loadImage.bind(t,p,f),m=c[p];if(null!=m){var v=u()-m;v<h?r=h-v:(r=0,delete c[p])}var _=a.bind(null,r);return s(_,(function(t){return o._loadPool.push(d,(function(n,r){n?(n instanceof i&&(c[p]=u(),o.emit("networkError",n,e)),t(n,e)):(delete c[p],t(null,e,r))}))}))(n)},c.fromString=function(t,e){var n=(e=e||{})&&e.cubeMapPreviewFaceOrder||"bdflru";return new c(e.cubeMapPreviewUrl?function(t){return 0===t.z?function(t){var r=n.indexOf(t.face)/6;return{url:e.cubeMapPreviewUrl,rect:{x:0,y:r,width:1,height:1/6}}}(t):r(t)}:r,e);function r(e){var n=t;for(var r in h){var i=h[r],o=l(r),s=e.hasOwnProperty(i)?e[i]:"";n=n.replace(o,s)}return{url:n}}},t.exports=c},541:function(t){"use strict";function e(t){this._asset=t}e.prototype.asset=function(){return this._asset},e.prototype.loadAsset=function(t,e,n){var r=this,i=setTimeout((function(){n(null,e,r._asset)}),0);return function(){clearTimeout(i),n.apply(null,arguments)}},t.exports=e},6611:function(t){"use strict";function e(){this._renderers={}}e.prototype.set=function(t,e,n){this._renderers[t]||(this._renderers[t]={}),this._renderers[t][e]=n},e.prototype.get=function(t,e){return this._renderers[t]&&this._renderers[t][e]||null},t.exports=e},244:function(t,e,n){"use strict";var r=n(5696),i=n(8585),o=n(6929),s=n(8667),a=n(610),u=n(6112),h=n(6611);function c(t,e){return t.cmp(e)}function l(t,e){return-t.cmp(e)}function p(t){this._progressive=!(!t||!t.progressive),this._layers=[],this._renderers=[],this._tilesToLoad=[],this._tilesToRender=[],this._tmpVisible=[],this._tmpChildren=[],this._width=0,this._height=0,this._tmpRect={},this._tmpSize={},this._createTextureWorkQueue=new i,this._emitRenderInvalid=this._emitRenderInvalid.bind(this),this._rendererRegistry=new h}r(p),p.prototype.destroy=function(){this.removeAllLayers(),u(this)},p.prototype.registerRenderer=function(t,e,n){return this._rendererRegistry.set(t,e,n)},p.prototype.domElement=function(){throw new Error("Stage implementation must override domElement")},p.prototype.width=function(){return this._width},p.prototype.height=function(){return this._height},p.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},p.prototype.setSize=function(t){this._width=t.width,this._height=t.height,this.setSizeForType(),this.emit("resize"),this._emitRenderInvalid()},p.prototype.setSizeForType=function(t){throw new Error("Stage implementation must override setSizeForType")},p.prototype.loadImage=function(){throw new Error("Stage implementation must override loadImage")},p.prototype._emitRenderInvalid=function(){this.emit("renderInvalid")},p.prototype.validateLayer=function(t){throw new Error("Stage implementation must override validateLayer")},p.prototype.listLayers=function(){return[].concat(this._layers)},p.prototype.hasLayer=function(t){return this._layers.indexOf(t)>=0},p.prototype.addLayer=function(t,e){if(this._layers.indexOf(t)>=0)throw new Error("Layer already in stage");if(null==e&&(e=this._layers.length),e<0||e>this._layers.length)throw new Error("Invalid layer position");this.validateLayer(t);var n=t.geometry().type,r=t.view().type,i=this._rendererRegistry.get(n,r);if(!i)throw new Error("No "+this.type+" renderer avaiable for "+n+" geometry and "+r+" view");var o=this.createRenderer(i);this._layers.splice(e,0,t),this._renderers.splice(e,0,o),t.addEventListener("viewChange",this._emitRenderInvalid),t.addEventListener("effectsChange",this._emitRenderInvalid),t.addEventListener("fixedLevelChange",this._emitRenderInvalid),t.addEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},p.prototype.moveLayer=function(t,e){var n=this._layers.indexOf(t);if(n<0)throw new Error("No such layer in stage");if(e<0||e>=this._layers.length)throw new Error("Invalid layer position");t=this._layers.splice(n,1)[0];var r=this._renderers.splice(n,1)[0];this._layers.splice(e,0,t),this._renderers.splice(e,0,r),this._emitRenderInvalid()},p.prototype.removeLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error("No such layer in stage");var n=this._layers.splice(e,1)[0],r=this._renderers.splice(e,1)[0];this.destroyRenderer(r),n.removeEventListener("viewChange",this._emitRenderInvalid),n.removeEventListener("effectsChange",this._emitRenderInvalid),n.removeEventListener("fixedLevelChange",this._emitRenderInvalid),n.removeEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},p.prototype.removeAllLayers=function(){for(;this._layers.length>0;)this.removeLayer(this._layers[0])},p.prototype.startFrame=function(){throw new Error("Stage implementation must override startFrame")},p.prototype.endFrame=function(){throw new Error("Stage implementation must override endFrame")},p.prototype.render=function(){var t,e,n,r=this._tilesToLoad,i=this._tilesToRender,s=!0,a=this._width,u=this._height,h=this._tmpRect,c=this._tmpSize;if(!(a<=0||u<=0)){for(this.startFrame(),t=0;t<this._layers.length;t++)this._layers[t].textureStore().startFrame();for(t=0;t<this._layers.length;t++){var l,p,f=this._layers[t],d=f.effects(),m=f.view(),v=f.textureStore(),_=this._renderers[t],y=this._layers.length-t;if(o(a,u,d&&d.rect,h),!(h.width<=0||h.height<=0)){for(c.width=h.width*this._width,c.height=h.height*this._height,m.setSize(c),_.startLayer(f,h),n=this._collectTiles(f,v),e=0;e<r.length;e++)l=r[e],v.markTile(l);for(e=0;e<i.length;e++)l=i[e],p=v.texture(l),_.renderTile(l,p,f,y);f.emit("renderComplete",n),n||(s=!1),_.endLayer(f,h)}}for(t=0;t<this._layers.length;t++)this._layers[t].textureStore().endFrame();this.endFrame(),this.emit("renderComplete",s)}},p.prototype._collectTiles=function(t,e){var n=this._tilesToLoad,r=this._tilesToRender,i=this._tmpVisible;n.length=0,r.length=0,i.length=0,t.visibleTiles(i);for(var o=!0,s=0;s<i.length;s++){var a,u=i[s];this._collectTileToLoad(u),e.texture(u)?(a=!1,this._collectTileToRender(u)):(a=this._collectChildren(u,e),o=!1),this._collectParents(u,e,a)}return n.sort(c),r.sort(l),o},p.prototype._collectChildren=function(t,e){var n=this._tmpChildren,r=!0;do{if(n.length=0,!t.children(n))break;r=!1;for(var i=0;i<n.length;i++)t=n[i],e.texture(t)?(this._collectTileToLoad(t),this._collectTileToRender(t)):r=!0}while(r&&1===n.length);return r},p.prototype._collectParents=function(t,e,n){for(var r=this._progressive;(r||n)&&null!=(t=t.parent());){if(n)if(e.texture(t))this._collectTileToRender(t),n=!1;else if(!this._progressive)continue;this._collectTileToLoad(t)||(r=!1)}return n},p.prototype._collectTileToLoad=function(t){return this._collectTileIntoList(t,this._tilesToLoad)},p.prototype._collectTileToRender=function(t){return this._collectTileIntoList(t,this._tilesToRender)},p.prototype._collectTileIntoList=function(t,e){for(var n=!1,r=0;r<e.length;r++)if(t.equals(e[r])){n=!0;break}return n||e.push(t),!n},p.prototype.createTexture=function(t,e,n){var r=this,i=a(s((function(){return new r.TextureClass(r,t,e)})));return this._createTextureWorkQueue.push(i,(function(r,i){n(r,t,e,i)}))},t.exports=p},5662:function(t,e,n){"use strict";var r=n(244),i=n(1317),o=n(2060),s=n(5003),a=n(2468),u=n(2533),h=n(6939).setAbsolute,c=n(6939).setFullSize,l=n(6112),p=o.chrome;function f(t){t=t||{};var e=this;this.constructor.super_.call(this,t),this._generateMipmaps=null!=t.generateMipmaps&&t.generateMipmaps,this._loader=new i(this),this._domElement=document.createElement("canvas"),h(this._domElement),c(this._domElement),this._gl=function(t,e){var n={alpha:!0,premultipliedAlpha:!0,antialias:!(!e||!e.antialias),preserveDrawingBuffer:!(!e||!e.preserveDrawingBuffer)},r=t.getContext&&(t.getContext("webgl",n)||t.getContext("experimental-webgl",n));if(!r)throw new Error("Could not get WebGL context");return e.wrapContext&&(r=e.wrapContext(r)),r}(this._domElement,t),this._handleContextLoss=function(){e.emit("webglcontextlost"),e._gl=null},this._domElement.addEventListener("webglcontextlost",this._handleContextLoss),this._rendererInstances=[]}function d(t,e,n){this._stage=t,this._gl=t._gl,this._texture=null,this._timestamp=null,this._width=this._height=null,this.refresh(e,n)}s(f,r),f.prototype.destroy=function(){this._domElement.removeEventListener("webglcontextlost",this._handleContextLoss),this.constructor.super_.prototype.destroy.call(this)},f.prototype.domElement=function(){return this._domElement},f.prototype.webGlContext=function(){return this._gl},f.prototype.setSizeForType=function(){var t=a();this._domElement.width=t*this._width,this._domElement.height=t*this._height},f.prototype.loadImage=function(t,e,n){return this._loader.loadImage(t,e,n)},f.prototype.maxTextureSize=function(){return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE)},f.prototype.validateLayer=function(t){var e=t.geometry().maxTileSize(),n=this.maxTextureSize();if(e>n)throw new Error("Layer has level with tile size larger than maximum texture size ("+e+" vs. "+n+")")},f.prototype.createRenderer=function(t){for(var e=this._rendererInstances,n=0;n<e.length;n++)if(e[n]instanceof t)return e[n];var r=new t(this._gl);return e.push(r),r},f.prototype.destroyRenderer=function(t){var e=this._rendererInstances;if(this._renderers.indexOf(t)<0){t.destroy();var n=e.indexOf(t);n>=0&&e.splice(n,1)}},f.prototype.startFrame=function(){var t=this._gl;if(!t)throw new Error("Bad WebGL context - maybe context was lost?");t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},f.prototype.endFrame=function(){},f.prototype.takeSnapshot=function(t){"object"==typeof t&&null!=t||(t={});var e=t.quality;if(void 0===e&&(e=75),"number"!=typeof e||e<0||e>100)throw new Error("WebGLStage: Snapshot quality needs to be a number between 0 and 100");return this.render(),this._domElement.toDataURL("image/jpeg",e/100)},f.type=f.prototype.type="webgl",d.prototype.refresh=function(t,e){var n,r=this._gl,i=this._stage,o=e.timestamp();if(o!==this._timestamp){var s=e.element(),a=e.width(),h=e.height();if(a!==this._width||h!==this._height){var c=i.maxTextureSize();if(a>c)throw new Error("Texture width larger than max size ("+a+" vs. "+c+")");if(h>c)throw new Error("Texture height larger than max size ("+h+" vs. "+c+")");this._texture&&r.deleteTexture(n),n=this._texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s)}else n=this._texture,r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s instanceof HTMLVideoElement&&p?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s):r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,s);i._generateMipmaps&&u(a)&&u(h)?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR),r.generateMipmap(r.TEXTURE_2D)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),this._timestamp=o,this._width=a,this._height=h}},d.prototype.destroy=function(){this._texture&&this._gl.deleteTexture(this._texture),l(this)},f.TextureClass=f.prototype.TextureClass=d,t.exports=f},8667:function(t){"use strict";t.exports=function(t){return function(e){var n,r;try{r=t()}catch(t){n=t}finally{n?e(n):e(null,r)}}}},6929:function(t){"use strict";t.exports=function(t,e,n,r){var i,o,s,a;return r=r||{},i=null!=n&&null!=n.absoluteWidth?n.absoluteWidth/t:null!=n&&null!=n.relativeWidth?n.relativeWidth:1,o=n&&null!=n.absoluteHeight?n.absoluteHeight/e:null!=n&&null!=n.relativeHeight?n.relativeHeight:1,s=null!=n&&null!=n.absoluteX?n.absoluteX/t:null!=n&&null!=n.relativeX?n.relativeX:0,a=null!=n&&null!=n.absoluteY?n.absoluteY/e:null!=n&&null!=n.relativeY?n.relativeY:0,r.x=s,r.y=a,r.width=i,r.height=o,r}},610:function(t,e,n){"use strict";var r=n(827);t.exports=function(t){return function(){if(!arguments.length)throw new Error("cancelized: expected at least one argument");var e=Array.prototype.slice.call(arguments,0),n=e[e.length-1]=r(e[e.length-1]);function i(){n.apply(null,arguments)}return t.apply(null,e),i}}},8111:function(t,e,n){"use strict";var r=n(3120);t.exports=function(){var t=Array.prototype.slice.call(arguments,0);return function(){var e=t.slice(0),n=null,i=null,o=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],s=arguments.length?arguments[arguments.length-1]:r;function a(){var t=arguments[0];if(t)return n=i=null,void s.apply(null,arguments);if(!e.length)return n=i=null,void s.apply(null,arguments);var r=n=e.shift(),o=Array.prototype.slice.call(arguments,1);o.push(a);var u=n.apply(null,o);if(r===n){if("function"!=typeof u)throw new Error("chain: chaining on non-cancellable function");i=u}}function u(){i&&i.apply(null,arguments)}return o.unshift(null),a.apply(null,o),u}}},5342:function(t){"use strict";t.exports=function(t,e,n){return Math.min(Math.max(t,e),n)}},6112:function(t){"use strict";t.exports=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]=void 0)}},7784:function(t){"use strict";t.exports=function(t,e){return t<e?-1:t>e?1:0}},6414:function(t){"use strict";t.exports=function(){var t=arguments;return function(e){for(var n=e,r=0;r<t.length;r++)n=t[r].call(null,n);return n}}},1745:function(t){"use strict";function e(t,e,n){return 2*Math.atan(n*Math.tan(t/2)/e)}t.exports={convert:e,htov:function(t,n,r){return e(t,n,r)},htod:function(t,n,r){return e(t,n,Math.sqrt(n*n+r*r))},vtoh:function(t,n,r){return e(t,r,n)},vtod:function(t,n,r){return e(t,r,Math.sqrt(n*n+r*r))},dtoh:function(t,n,r){return e(t,Math.sqrt(n*n+r*r),n)},dtov:function(t,n,r){return e(t,Math.sqrt(n*n+r*r),r)}}},4743:function(t){"use strict";t.exports=function(t){return t.toPrecision(15)}},9821:function(t){"use strict";t.exports=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t}},3522:function(t){"use strict";t.exports=function(t,e){setTimeout((function(){e&&e.length>0?t.apply(null,e):t()}),0)}},6389:function(t){"use strict";t.exports=function(t){return t*Math.PI/180}},9300:function(t){"use strict";t.exports=function(t,e){var n=null;return n=setTimeout((function(){null!=n&&(n=null,e(null))}),t),function(){null!=n&&(clearTimeout(n),n=null,e.apply(null,arguments))}}},6939:function(t){"use strict";function e(t){for(var e=document.documentElement.style,n=["Moz","Webkit","Khtml","O","ms"],r=0;r<n.length;r++){var i=n[r]+(t[0].toUpperCase()+t.slice(1));if(i in e)return i}return t}function n(t){var n=e(t);return function(t,e){return t.style[n]=e}}var r=n("transform"),i=n("transformOrigin");t.exports={prefixProperty:e,getWithVendorPrefix:function(t){var n=e(t);return function(t){return t.style[n]}},setWithVendorPrefix:n,setTransform:r,setTransformOrigin:i,setNullTransform:function(t){r(t,"translateZ(0)")},setNullTransformOrigin:function(t){i(t,"0 0 0")},setAbsolute:function(t){t.style.position="absolute"},setPixelPosition:function(t,e,n){t.style.left=e+"px",t.style.top=n+"px"},setPixelSize:function(t,e,n){t.style.width=e+"px",t.style.height=n+"px"},setNullSize:function(t){t.style.width=t.style.height=0},setFullSize:function(t){t.style.width=t.style.height="100%"},setOverflowHidden:function(t){t.style.overflow="hidden"},setOverflowVisible:function(t){t.style.overflow="visible"},setNoPointerEvents:function(t){t.style.pointerEvents="none"},setBlocking:function(t){t.style.backgroundColor="#000",t.style.opacity="0",t.style.filter="alpha(opacity=0)"}}},8804:function(t){"use strict";t.exports=function(t,e){for(var n in e)t[n]=e[n];return t}},5135:function(t,e,n){"use strict";var r="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:null;t.exports=r},6056:function(t){"use strict";t.exports=function(){for(var t=0,e=0;e<arguments.length;e++){var n=arguments[e];t+=n,t+=n<<10,t^=n>>6}return t+=t<<3,t^=t>>11,(t+=t<<15)>=0?t:-t}},5003:function(t){"use strict";t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},2533:function(t){"use strict";t.exports=function(t){return 0==(t&t-1)}},8001:function(t){"use strict";t.exports=function(t,e){return(+t%(e=+e)+e)%e}},3120:function(t){"use strict";t.exports=function(){}},1227:function(t){"use strict";t.exports="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()}},827:function(t){"use strict";t.exports=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}}},2468:function(t){"use strict";t.exports=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t&&t.deviceXDPI&&t.logicalXDPI)return t.deviceXDPI/t.logicalXDPI;if(t&&t.systemXDPI&&t.logicalXDPI)return t.systemXDPI/t.logicalXDPI}return 1}},7691:function(t,e,n){"use strict";var r=n(6939).setTransform,i=n(4743);t.exports=function(t,e,n,o){o=o||"";var s="translateX("+i(e)+"px) translateY("+i(n)+"px) translateZ(0) "+o;r(t,s)}},910:function(t){"use strict";t.exports=function(t){return 180*t/Math.PI}},6467:function(t){"use strict";t.exports=function(t){return"number"==typeof t&&isFinite(t)}},2582:function(t,e,n){"use strict";var r=n(3120);t.exports=function(t){return function(){var e=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],n=arguments.length?arguments[arguments.length-1]:r,i=null,o=!1;function s(){var r=arguments[0];!r||o?n.apply(null,arguments):i=t.apply(null,e)}return e.push(s),s(!0),function(){o=!0,i.apply(null,arguments)}}}},5026:function(t,e,n){"use strict";var r=n(1227);t.exports=function(t,e,n){var i=!1,o=r();return e(0),requestAnimationFrame((function s(){if(!i){var a=(r()-o)/t;a<1?(e(a),requestAnimationFrame(s)):(e(1),n())}})),function(){i=!0,n.apply(null,arguments)}}},3969:function(t){"use strict";t.exports=function(t){var e=typeof t;if("object"===e){if(null===t)return"null";if("[object Array]"===Object.prototype.toString.call(t))return"array";if("[object RegExp]"===Object.prototype.toString.call(t))return"regexp"}return e}},8793:function(t,e,n){"use strict";var r=n(5696),i=n(887).mat4,o=n(887).vec4,s=n(2468),a=n(6467),u=n(5342),h=n(6112),c=[1,0,1,0],l=[-1,-1,1,1];function p(t,e){if(!t||null==t.mediaAspectRatio)throw new Error("mediaAspectRatio must be defined");this._x=t&&null!=t.x?t.x:.5,this._y=t&&null!=t.y?t.y:.5,this._zoom=t&&null!=t.zoom?t.zoom:1,this._mediaAspectRatio=t.mediaAspectRatio,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._limiter=e||null,this._projMatrix=i.create(),this._invProjMatrix=i.create(),this._frustum=[0,0,0,0],this._projectionChanged=!0,this._params={},this._vec=o.create(),this._update()}r(p),p.prototype.destroy=function(){h(this)},p.prototype.x=function(){return this._x},p.prototype.y=function(){return this._y},p.prototype.zoom=function(){return this._zoom},p.prototype.mediaAspectRatio=function(){return this._mediaAspectRatio},p.prototype.width=function(){return this._width},p.prototype.height=function(){return this._height},p.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},p.prototype.parameters=function(t){return(t=t||{}).x=this._x,t.y=this._y,t.zoom=this._zoom,t.mediaAspectRatio=this._mediaAspectRatio,t},p.prototype.limiter=function(){return this._limiter},p.prototype.setX=function(t){this._resetParams(),this._params.x=t,this._update(this._params)},p.prototype.setY=function(t){this._resetParams(),this._params.y=t,this._update(this._params)},p.prototype.setZoom=function(t){this._resetParams(),this._params.zoom=t,this._update(this._params)},p.prototype.offsetX=function(t){this.setX(this._x+t)},p.prototype.offsetY=function(t){this.setY(this._y+t)},p.prototype.offsetZoom=function(t){this.setZoom(this._zoom+t)},p.prototype.setMediaAspectRatio=function(t){this._resetParams(),this._params.mediaAspectRatio=t,this._update(this._params)},p.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},p.prototype.setParameters=function(t){this._resetParams(),this._params.x=t.x,this._params.y=t.y,this._params.zoom=t.zoom,this._params.mediaAspectRatio=t.mediaAspectRatio,this._update(this._params)},p.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},p.prototype._resetParams=function(){var t=this._params;t.x=null,t.y=null,t.zoom=null,t.mediaAspectRatio=null,t.width=null,t.height=null},p.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._x,n=this._y,r=this._zoom,i=this._mediaAspectRatio,o=this._width,s=this._height;if(t.x=null!=t.x?t.x:e,t.y=null!=t.y?t.y:n,t.zoom=null!=t.zoom?t.zoom:r,t.mediaAspectRatio=null!=t.mediaAspectRatio?t.mediaAspectRatio:i,t.width=null!=t.width?t.width:o,t.height=null!=t.height?t.height:s,this._limiter&&!(t=this._limiter(t)))throw new Error("Bad view limiter");var h=t.x,c=t.y,l=t.zoom,p=t.mediaAspectRatio,f=t.width,d=t.height;if(!(a(h)&&a(c)&&a(l)&&a(p)&&a(f)&&a(d)))throw new Error("Bad view - suspect a broken limiter");l=u(l,1e-6,1/0),this._x=h,this._y=c,this._zoom=l,this._mediaAspectRatio=p,this._width=f,this._height=d,h===e&&c===n&&l===r&&p===i&&f===o&&d===s||(this._projectionChanged=!0,this.emit("change")),f===o&&d===s||this.emit("resize")},p.prototype._zoomX=function(){return this._zoom},p.prototype._zoomY=function(){var t=this._mediaAspectRatio,e=this._width/this._height,n=this._zoom,r=n*t/e;return isNaN(r)&&(r=n),r},p.prototype.updateWithControlParameters=function(t){var e=this.zoom(),n=this._zoomX(),r=this._zoomY();this.offsetX(t.axisScaledX*n+t.x*e),this.offsetY(t.axisScaledY*r+t.y*e),this.offsetZoom(t.zoom*e)},p.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var r=this._x,o=this._y,s=this._zoomX(),a=this._zoomY(),u=n[0]=.5-o+.5*a,h=n[1]=r-.5+.5*s,c=n[2]=.5-o-.5*a,l=n[3]=r-.5-.5*s;i.ortho(t,l,h,c,u,-1,1),i.invert(e,t),this._projectionChanged=!1}},p.prototype.projection=function(){return this._updateProjection(),this._projMatrix},p.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},p.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=0;n<e.length;n++){for(var r=e[n],i=c[n],o=l[n],s=!1,a=0;a<t.length;a++){var u=t[a];if(o<0&&u[i]<r||o>0&&u[i]>r){s=!0;break}}if(!s)return!1}return!0},p.prototype.selectLevel=function(t){for(var e=s()*this.width(),n=this._zoom,r=0;r<t.length;r++){var i=t[r];if(n*i.width()>=e)return i}return t[t.length-1]},p.prototype.coordinatesToScreen=function(t,e){var n=this._vec;e||(e={});var r=this._width,i=this._height;if(r<=0||i<=0)return e.x=null,e.y=null,null;var s=t&&null!=t.x?t.x:.5,a=t&&null!=t.y?t.y:.5;o.set(n,s-.5,.5-a,-1,1),o.transformMat4(n,n,this.projection());for(var u=0;u<3;u++)n[u]/=n[3];return e.x=r*(n[0]+1)/2,e.y=i*(1-n[1])/2,e},p.prototype.screenToCoordinates=function(t,e){var n=this._vec;e||(e={});var r=this._width,i=this._height,s=2*t.x/r-1,a=1-2*t.y/i;return o.set(n,s,a,1,1),o.transformMat4(n,n,this.inverseProjection()),e.x=.5+n[0],e.y=.5-n[1],e},p.limit={x:function(t,e){return function(n){return n.x=u(n.x,t,e),n}},y:function(t,e){return function(n){return n.y=u(n.y,t,e),n}},zoom:function(t,e){return function(n){return n.zoom=u(n.zoom,t,e),n}},resolution:function(t){return function(e){if(e.width<=0||e.height<=0)return e;var n=e.width,r=s()*n/t;return e.zoom=u(e.zoom,r,1/0),e}},visibleX:function(t,e){return function(n){var r=e-t;n.zoom>r&&(n.zoom=r);var i=t+.5*n.zoom,o=e-.5*n.zoom;return n.x=u(n.x,i,o),n}},visibleY:function(t,e){return function(n){if(n.width<=0||n.height<=0)return n;var r=n.width/n.height/n.mediaAspectRatio,i=(e-t)*r;n.zoom>i&&(n.zoom=i);var o=t+.5*n.zoom/r,s=e-.5*n.zoom/r;return n.y=u(n.y,o,s),n}},letterbox:function(){return function(t){if(t.width<=0||t.height<=0)return t;var e,n,r,i,o=t.width/t.height,s=o/t.mediaAspectRatio;return t.mediaAspectRatio>=o&&(t.zoom=Math.min(t.zoom,1)),t.mediaAspectRatio<=o&&(t.zoom=Math.min(t.zoom,s)),t.zoom>1?e=n=.5:(e=0+.5*t.zoom/1,n=1-.5*t.zoom/1),t.zoom>s?r=i=.5:(r=0+.5*t.zoom/s,i=1-.5*t.zoom/s),t.x=u(t.x,e,n),t.y=u(t.y,r,i),t}}},p.type=p.prototype.type="flat",t.exports=p},3070:function(t,e,n){"use strict";var r=n(5696),i=n(887).mat4,o=n(887).vec4,s=n(2468),a=n(1745),u=n(8001),h=n(6467),c=n(5342),l=n(4743),p=n(6414),f=n(6112),d=Math.PI/4,m=1e-6;function v(t,e){this._yaw=t&&null!=t.yaw?t.yaw:0,this._pitch=t&&null!=t.pitch?t.pitch:0,this._roll=t&&null!=t.roll?t.roll:0,this._fov=t&&null!=t.fov?t.fov:d,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._projectionCenterX=t&&null!=t.projectionCenterX?t.projectionCenterX:0,this._projectionCenterY=t&&null!=t.projectionCenterY?t.projectionCenterY:0,this._limiter=e||null,this._projMatrix=i.create(),this._invProjMatrix=i.create(),this._frustum=[o.create(),o.create(),o.create(),o.create(),o.create()],this._projectionChanged=!0,this._params={},this._fovs={},this._tmpVec=o.create(),this._update()}r(v),v.prototype.destroy=function(){f(this)},v.prototype.yaw=function(){return this._yaw},v.prototype.pitch=function(){return this._pitch},v.prototype.roll=function(){return this._roll},v.prototype.projectionCenterX=function(){return this._projectionCenterX},v.prototype.projectionCenterY=function(){return this._projectionCenterY},v.prototype.fov=function(){return this._fov},v.prototype.width=function(){return this._width},v.prototype.height=function(){return this._height},v.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},v.prototype.parameters=function(t){return(t=t||{}).yaw=this._yaw,t.pitch=this._pitch,t.roll=this._roll,t.fov=this._fov,t},v.prototype.limiter=function(){return this._limiter},v.prototype.setYaw=function(t){this._resetParams(),this._params.yaw=t,this._update(this._params)},v.prototype.setPitch=function(t){this._resetParams(),this._params.pitch=t,this._update(this._params)},v.prototype.setRoll=function(t){this._resetParams(),this._params.roll=t,this._update(this._params)},v.prototype.setFov=function(t){this._resetParams(),this._params.fov=t,this._update(this._params)},v.prototype.setProjectionCenterX=function(t){this._resetParams(),this._params.projectionCenterX=t,this._update(this._params)},v.prototype.setProjectionCenterY=function(t){this._resetParams(),this._params.projectionCenterY=t,this._update(this._params)},v.prototype.offsetYaw=function(t){this.setYaw(this._yaw+t)},v.prototype.offsetPitch=function(t){this.setPitch(this._pitch+t)},v.prototype.offsetRoll=function(t){this.setRoll(this._roll+t)},v.prototype.offsetFov=function(t){this.setFov(this._fov+t)},v.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},v.prototype.setParameters=function(t){this._resetParams(),this._params.yaw=t.yaw,this._params.pitch=t.pitch,this._params.roll=t.roll,this._params.fov=t.fov,this._params.projectionCenterX=t.projectionCenterX,this._params.projectionCenterY=t.projectionCenterY,this._update(this._params)},v.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},v.prototype._resetParams=function(){var t=this._params;t.yaw=null,t.pitch=null,t.roll=null,t.fov=null,t.width=null,t.height=null},v.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._yaw,n=this._pitch,r=this._roll,i=this._fov,o=this._projectionCenterX,s=this._projectionCenterY,a=this._width,u=this._height;if(t.yaw=null!=t.yaw?t.yaw:e,t.pitch=null!=t.pitch?t.pitch:n,t.roll=null!=t.roll?t.roll:r,t.fov=null!=t.fov?t.fov:i,t.width=null!=t.width?t.width:a,t.height=null!=t.height?t.height:u,t.projectionCenterX=null!=t.projectionCenterX?t.projectionCenterX:o,t.projectionCenterY=null!=t.projectionCenterY?t.projectionCenterY:s,this._limiter&&!(t=this._limiter(t)))throw new Error("Bad view limiter");var c=(t=this._normalize(t)).yaw,l=t.pitch,p=t.roll,f=t.fov,d=t.width,m=t.height,v=t.projectionCenterX,_=t.projectionCenterY;if(!(h(c)&&h(l)&&h(p)&&h(f)&&h(d)&&h(m)&&h(v)&&h(_)))throw new Error("Bad view - suspect a broken limiter");this._yaw=c,this._pitch=l,this._roll=p,this._fov=f,this._width=d,this._height=m,this._projectionCenterX=v,this._projectionCenterY=_,c===e&&l===n&&p===r&&f===i&&d===a&&m===u&&v===o&&_===s||(this._projectionChanged=!0,this.emit("change")),d===a&&m===u||this.emit("resize")},v.prototype._normalize=function(t){this._normalizeCoordinates(t);var e=a.htov(Math.PI,t.width,t.height),n=isNaN(e)?Math.PI:Math.min(Math.PI,e);return t.fov=c(t.fov,m,n-m),t},v.prototype._normalizeCoordinates=function(t){return"yaw"in t&&(t.yaw=u(t.yaw-Math.PI,-2*Math.PI)+Math.PI),"pitch"in t&&(t.pitch=u(t.pitch-Math.PI,-2*Math.PI)+Math.PI),"roll"in t&&(t.roll=u(t.roll-Math.PI,-2*Math.PI)+Math.PI),t},v.prototype.normalizeToClosest=function(t,e){var n=this._yaw,r=this._pitch,i=t.yaw,o=t.pitch,s=i-2*Math.PI,a=i+2*Math.PI;Math.abs(s-n)<Math.abs(i-n)?i=s:Math.abs(a-n)<Math.abs(i-n)&&(i=a);var u=o-2*Math.PI,h=o+2*Math.PI;return Math.abs(u-r)<Math.abs(o-r)?o=u:Math.abs(u-r)<Math.abs(o-r)&&(o=h),(e=e||{}).yaw=i,e.pitch=o,e},v.prototype.updateWithControlParameters=function(t){var e=this._fov,n=a.vtoh(e,this._width,this._height);isNaN(n)&&(n=e),this.offsetYaw(t.axisScaledX*n+2*t.x*n+t.yaw),this.offsetPitch(t.axisScaledY*e+2*t.y*n+t.pitch),this.offsetRoll(-t.roll),this.offsetFov(t.zoom*e)},v.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var r=this._width,o=this._height,s=this._fov,u=a.vtoh(s,r,o),h=r/o,c=this._projectionCenterX,l=this._projectionCenterY;if(0!==c||0!==l){var p=Math.atan(2*c*Math.tan(u/2)),f=Math.atan(2*l*Math.tan(s/2)),d=this._fovs;d.leftDegrees=180*(u/2+p)/Math.PI,d.rightDegrees=180*(u/2-p)/Math.PI,d.upDegrees=180*(s/2+f)/Math.PI,d.downDegrees=180*(s/2-f)/Math.PI,i.perspectiveFromFieldOfView(t,d,-1,1)}else i.perspective(t,s,h,-1,1);i.rotateZ(t,t,this._roll),i.rotateX(t,t,this._pitch),i.rotateY(t,t,this._yaw),i.invert(e,t),this._matrixToFrustum(t,n),this._projectionChanged=!1}},v.prototype._matrixToFrustum=function(t,e){o.set(e[0],t[3]+t[0],t[7]+t[4],t[11]+t[8],0),o.set(e[1],t[3]-t[0],t[7]-t[4],t[11]-t[8],0),o.set(e[2],t[3]+t[1],t[7]+t[5],t[11]+t[9],0),o.set(e[3],t[3]-t[1],t[7]-t[5],t[11]-t[9],0),o.set(e[4],t[3]+t[2],t[7]+t[6],t[11]+t[10],0)},v.prototype.projection=function(){return this._updateProjection(),this._projMatrix},v.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},v.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=this._tmpVec,r=0;r<e.length;r++){for(var i=e[r],s=!1,a=0;a<t.length;a++){var u=t[a];o.set(n,u[0],u[1],u[2],0),o.dot(i,n)>=0&&(s=!0)}if(!s)return!1}return!0},v.prototype.selectLevel=function(t){for(var e=s()*this._height,n=Math.tan(.5*this._fov),r=0;r<t.length;r++){var i=t[r];if(n*i.height()>=e)return i}return t[t.length-1]},v.prototype.coordinatesToScreen=function(t,e){var n=this._tmpVec;e||(e={});var r=this._width,i=this._height;if(r<=0||i<=0)return e.x=null,e.y=null,null;var s=t.yaw,a=t.pitch,u=Math.sin(s)*Math.cos(a),h=-Math.sin(a),c=-Math.cos(s)*Math.cos(a);return o.set(n,u,h,c,1),o.transformMat4(n,n,this.projection()),n[3]>=0?(e.x=r*(n[0]/n[3]+1)/2,e.y=i*(1-n[1]/n[3])/2,e):(e.x=null,e.y=null,null)},v.prototype.screenToCoordinates=function(t,e){var n=this._tmpVec;e||(e={});var r=this._width,i=this._height,s=2*t.x/r-1,a=1-2*t.y/i;o.set(n,s,a,1,1),o.transformMat4(n,n,this.inverseProjection());var u=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return e.yaw=Math.atan2(n[0],-n[2]),e.pitch=Math.acos(n[1]/u)-Math.PI/2,this._normalizeCoordinates(e),e},v.prototype.coordinatesToPerspectiveTransform=function(t,e,n){n=n||"";var r=this._height,i=this._width,o=this._fov,s=.5*r/Math.tan(o/2),a="";return a+="translateX("+l(i/2)+"px) ",a+="translateY("+l(r/2)+"px) ",a+="translateX(-50%) translateY(-50%) ",a+="perspective("+l(s)+"px) ",a+="translateZ("+l(s)+"px) ",a+="rotateZ("+l(-this._roll)+"rad) ",a+="rotateX("+l(-this._pitch)+"rad) ",a+="rotateY("+l(this._yaw)+"rad) ",a+="rotateY("+l(-t.yaw)+"rad) ",a+="rotateX("+l(t.pitch)+"rad) ",(a+="translateZ("+l(-e)+"px) ")+(n+" ")},v.limit={yaw:function(t,e){return function(n){return n.yaw=c(n.yaw,t,e),n}},pitch:function(t,e){return function(n){return n.pitch=c(n.pitch,t,e),n}},roll:function(t,e){return function(n){return n.roll=c(n.roll,t,e),n}},hfov:function(t,e){return function(n){var r=n.width,i=n.height;if(r>0&&i>0){var o=a.htov(t,r,i),s=a.htov(e,r,i);n.fov=c(n.fov,o,s)}return n}},vfov:function(t,e){return function(n){return n.fov=c(n.fov,t,e),n}},resolution:function(t){return function(e){var n=e.height;if(n){var r=s()*n,i=2*Math.atan(r/t);e.fov=c(e.fov,i,1/0)}return e}},traditional:function(t,e,n){return n=null!=n?n:e,p(v.limit.resolution(t),v.limit.vfov(0,e),v.limit.hfov(0,n),v.limit.pitch(-Math.PI/2,Math.PI/2))}},v.type=v.prototype.type="rectilinear",t.exports=v},5696:function(t){"use strict";function e(){}e.prototype.addEventListener=function(t,e){var n=this.__events=this.__events||{},r=n[t]=n[t]||[];r.indexOf(e)<0&&r.push(e)},e.prototype.removeEventListener=function(t,e){var n=(this.__events=this.__events||{})[t];if(n){var r=n.indexOf(e);r>=0&&n.splice(r,1)}},e.prototype.emit=function(t,e){var n=this.__events=this.__events||{},r=n[t],i=Array.prototype.slice.call(arguments,1);if(r)for(var o=0;o<r.length;o++){var s=r[o];s.apply(this,i)}},t.exports=function(t){for(var n in e.prototype)e.prototype.hasOwnProperty(n)&&(t.prototype[n]=e.prototype[n])}},577:function(t){!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,r=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if((t=n[r])&&t[1]in e){for(r=0;r<t.length;r++)o[n[0][r]]=t[r];return o}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(t,n){return new Promise(function(i,o){var s=function(){this.off("change",s),i()}.bind(this);this.on("change",s);var a=(t=t||e.documentElement)[r.requestFullscreen](n);a instanceof Promise&&a.then(s).catch(o)}.bind(this))},exit:function(){return new Promise(function(t,n){if(this.isFullscreen){var i=function(){this.off("change",i),t()}.bind(this);this.on("change",i);var o=e[r.exitFullscreen]();o instanceof Promise&&o.then(i).catch(n)}else t()}.bind(this))},toggle:function(t,e){return this.isFullscreen?this.exit():this.request(t,e)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var r=i[t];r&&e.addEventListener(r,n,!1)},off:function(t,n){var r=i[t];r&&e.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(e[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(e[r.fullscreenEnabled])}}}),n?t.exports=o:window.screenfull=o):n?t.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.amdO={},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){"use strict";var t=n(5982),e=n.n(t),r=n(2060),i=n(577),o=n.n(i);const s=window.APP_DATA,a=document.querySelector("#pano"),u=document.querySelector("#titleBar .sceneName"),h=(document.querySelector("#sceneList"),document.querySelectorAll("#sceneList .scene")),c=(document.querySelector("#sceneListToggle"),document.querySelector("#fullscreenToggle"));if(window.matchMedia){const t=function(){e.matches?(document.body.classList.remove("desktop"),document.body.classList.add("mobile")):(document.body.classList.remove("mobile"),document.body.classList.add("desktop"))},e=matchMedia("(max-width: 700px), (max-height: 500px)");t(),e.addListener(t)}else document.body.classList.add("desktop");document.body.classList.add("no-touch"),window.addEventListener("touchstart",(function(t){document.body.classList.remove("no-touch"),document.body.classList.add("touch")})),r.default.msie&&parseFloat(r.default.version)<11&&document.body.classList.add("tooltip-fallback");const l={controls:{mouseViewMode:s.settings.mouseViewMode,scrollZoom:!1}},p=new(e().Viewer)(a,l),f=s.scenes.map((function(t){const n=e().ImageUrlSource.fromString("tiles/"+t.id+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:"tiles/"+t.id+"/preview.jpg"}),r=new(e().CubeGeometry)(t.levels),i=e().RectilinearView.limit.traditional(t.faceSize,100*Math.PI/180,120*Math.PI/180),o=new(e().RectilinearView)(t.initialViewParameters,i),s=p.createScene({source:n,geometry:r,view:o,pinFirstLevel:!0});return t.linkHotspots.forEach((function(t){const e=function(t){const e=document.createElement("div");e.classList.add("hotspot"),e.classList.add("link-hotspot");const n=document.createElement("img");n.src="./SVG/arrow-up-circle-fill.svg",n.classList.add("link-hotspot-icon");const r=["-ms-transform","-webkit-transform","transform"];for(let e=0;e<r.length;e++){const i=r[e];n.style[i]="rotate("+t.rotation+"rad)"}e.addEventListener("click",(function(){d(function(t){for(let e=0;e<f.length;e++)if(f[e].data.id===t)return f[e];return null}(t.target))}));const i=document.createElement("div");return i.classList.add("hotspot-tooltip"),i.classList.add("link-hotspot-tooltip"),i.innerHTML=m(t.target).name,e.appendChild(n),e.appendChild(i),e}(t);s.hotspotContainer().createHotspot(e,{yaw:t.yaw,pitch:t.pitch})})),t.infoHotspots.forEach((function(t){const e=function(t){const e=document.createElement("div");e.classList.add("hotspot"),e.classList.add("info-hotspot");const n=document.createElement("div");n.classList.add("info-hotspot-header");const r=document.createElement("div");r.classList.add("info-hotspot-icon-wrapper");const i=document.createElement("img");i.src="./assets/PC-Seal_Solid-white-95black_Registered.png",i.classList.add("info-hotspot-icon"),r.appendChild(i);const o=document.createElement("div");o.classList.add("info-hotspot-title-wrapper");const s=document.createElement("div");s.classList.add("info-hotspot-title"),s.innerHTML=t.title,o.appendChild(s);const a=document.createElement("div");a.classList.add("info-hotspot-close-wrapper");const u=document.createElement("img");u.src="./SVG/close-line.svg",u.classList.add("info-hotspot-close-icon"),a.appendChild(u),n.appendChild(r),n.appendChild(o),n.appendChild(a);const h=document.createElement("div");h.classList.add("info-hotspot-content");const c=document.createElement("div");c.classList.add("product-txt-container");const l=document.createElement("div");l.classList.add("product-txt-wrapper");const p=document.createElement("h2");p.classList.add("product-txt-subhead"),p.innerHTML=t.subhead;const f=document.createElement("div");f.innerHTML=t.text,f.classList.add("product-txt");const d=document.createElement("div");d.classList.add("recipes");const m=document.createElement("h2");m.classList.add("recipes-header"),m.textContent="Recipes to Try:",d.appendChild(m);const v=document.createElement("div");if(v.classList.add("recipes-list"),null!=t.recipes)for(let e=0;e<t.recipes.length;e++){const n=document.createElement("li"),r=document.createElement("a");r.classList.add("recipe-link"),r.href=t.recipes[e].link,r.setAttribute("target","_blank");const i=document.createElement("div");i.classList.add("recipe-preview-img-wrap"),i.style.backgroundImage=`url(${t.recipes[e].preview_image})`;const o=document.createElement("p");o.classList.add("recipe-title"),o.innerHTML=t.recipes[e].id,o.href=t.recipes[e].link,o.setAttribute("target","_blank"),r.appendChild(i),r.appendChild(o),n.appendChild(r),v.appendChild(n)}else if(null!=t.related_content){for(let e=0;e<t.related_content.length;e++){const n=document.createElement("li"),r=document.createElement("a");r.classList.add("recipe-link"),r.href=t.related_content[e].link,r.setAttribute("target","_blank");const i=document.createElement("div");i.classList.add("recipe-preview-img-wrap"),i.classList.add("__related-content"),i.style.backgroundImage=`url(${t.related_content[e].preview_image})`;const o=document.createElement("p");o.classList.add("recipe-title"),o.classList.add("__related_"),o.innerHTML=t.related_content[e].id,o.href=t.related_content[e].link,o.setAttribute("target","_blank"),r.appendChild(i),r.appendChild(o),n.appendChild(r),v.appendChild(n)}m.textContent="Related Content:"}else if(null!=t.pdf_links){for(let e=0;e<t.pdf_links.length;e++){const n=document.createElement("li"),r=document.createElement("a");r.classList.add("recipe-link"),r.href=t.pdf_links[e].link,r.setAttribute("target","_blank");const i=document.createElement("div");r.appendChild(i),i.classList.add("recipe-preview-img-wrap"),i.style.backgroundImage=`url(${t.pdf_links[e].preview_image})`;const o=document.createElement("p");o.classList.add("recipe-title"),o.innerHTML=t.pdf_links[e].id,o.href=t.pdf_links[e].link,o.setAttribute("target","_blank"),r.appendChild(o),n.appendChild(r),v.appendChild(n)}m.textContent="Downloads"}else m.textContent="";d.appendChild(v),l.appendChild(p),l.appendChild(f),l.appendChild(d),c.appendChild(l);const _=document.createElement("div");_.classList.add("carousel_container");const y=document.createElement("div");y.classList.add("carousel");const g=document.createElement("div");g.classList.add("carousel-images");const w=document.createElement("div");w.classList.add("carousel-nav");const M=document.createElement("img");M.src="./SVG/chevron-right.svg",M.classList.add("carousel-button"),M.classList.add("next"),M.setAttribute("id","next");const b=document.createElement("img");b.src="./SVG/chevron-left.svg",b.classList.add("carousel-button"),b.classList.add("previous"),b.setAttribute("id","previous");const x=document.createElement("ul");x.classList.add("carousel-pagination");for(let e=0;e<t.images.length;e++){const n=document.createElement("li");n.classList.add("carousel-bullet");const r=document.createElement("div");if(2===t.images[e].length){r.style.backgroundImage=`url(${t.images[e][1]})`;const n=document.createElement("div");n.classList.add("influencer_credit_container");const i=document.createElement("div");i.classList.add("pointer"),n.appendChild(i);const o=document.createElement("span");o.classList.add("influencer_credit"),o.innerHTML=": "+t.images[e][0],n.appendChild(o),r.appendChild(n)}else r.style.backgroundImage=`url(${t.images[e]})`;r.classList.add("product-image"),t.containImages&&(r.style.backgroundSize="contain",r.style.width="80%",r.style.height="80%",r.style.alignSelf="center"),g.appendChild(r),x.appendChild(n),_.appendChild(x)}if(null!=t.videos)for(let e=0;e<t.videos.length;e++){const n=document.createElement("li");n.classList.add("carousel-bullet");const r=document.createElement("div");r.classList.add("iframe_container__video"),r.innerHTML=t.videos[e],x.appendChild(n),g.appendChild(r)}w.appendChild(M),y.appendChild(g),w.appendChild(b),_.appendChild(w),_.appendChild(y),h.appendChild(c),h.appendChild(_),e.appendChild(n),e.appendChild(h);const E=document.createElement("div");E.innerHTML=e.innerHTML,E.classList.add("info-hotspot-modal"),document.body.appendChild(E);const T=function(){let t=E.getElementsByTagName("iframe");if(null!=t)for(let e=0;e<t.length;e++)t[e].src=t[e].src},L=function(){setTimeout((function(){E.querySelector(".product-txt-container")&&(E.querySelector(".product-txt-container").scrollTo(0,0),O(0))}),1e3),T()},C=function(){E.classList.toggle("visible")};e.querySelector(".info-hotspot-header").addEventListener("click",C),E.querySelector(".info-hotspot-close-wrapper").addEventListener("click",C),E.addEventListener("mouseover",(function(t){t.target===E&&E.classList.contains("visible")&&E.addEventListener("click",(function(t){t.target===E&&E.classList.contains("visible")&&(E.classList.remove("visible"),L())}))}));const S=E.querySelector("#next"),P=E.querySelector("#previous"),A=E.querySelector(".carousel-images"),R=E.querySelectorAll(".carousel-images > *").length,z=E.querySelector(".carousel-pagination"),F=[].slice.call(E.querySelectorAll(".carousel-bullet"));let k=0,I=0,H=0;function O(t){t=t<0?R-1:t>=R?0:t,A.style.WebkitTransform=A.style.transform="translate(-"+100*t+"%, 0)",F[k].classList.remove("active-bullet"),F[t].classList.add("active-bullet"),k=t,T()}if(document.body.addEventListener("keydown",(t=>{"Escape"===t.key&&E.classList.remove("visible"),L()}),{passive:!0}),A.addEventListener("touchstart",(t=>{I=t.changedTouches[0].pageX})),A.addEventListener("touchend",(t=>{H=t.changedTouches[0].pageX,H<I&&k!==R-1&&S.click(),H>I&&0!==k&&P.click()})),A.addEventListener("wheel",(t=>{let e=1*t.deltaY;-1===Math.sign(e)?0!==k&&P.click():k!==R-1&&S.click()}),{passive:!0}),F[k].classList.add("active-bullet"),P.addEventListener("click",(function(){O(k-1)}),!1),S.addEventListener("click",(function(){O(k+1)}),!1),z.addEventListener("click",(function(t){let e=F.indexOf(t.target);-1!==e&&e!==k&&O(e)}),!1),t.fullWidth){let e=E.querySelector("div.info-hotspot-content");e.classList.add("fullwidth_modal"),function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(e);const n=document.createElement("div");n.classList.add("iframe_container"),n.innerHTML=t.text,e.appendChild(n)}return e}(t);s.hotspotContainer().createHotspot(e,{yaw:t.yaw,pitch:t.pitch},{perspective:{radius:500}})})),{data:t,scene:s,view:o}}));function d(t){t.view.setParameters(t.data.initialViewParameters),t.scene.switchTo(),function(t){u.innerHTML=t.data.name.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}(t),function(t){for(let e=0;e<h.length;e++){const n=h[e];n.getAttribute("data-id")===t.data.id?n.classList.add("current"):n.classList.remove("current")}}(t)}function m(t){for(let e=0;e<s.scenes.length;e++)if(s.scenes[e].id===t)return s.scenes[e];return null}o().enabled&&s.settings.fullscreenButton?(document.body.classList.add("fullscreen-enabled"),c.addEventListener("click",(function(){o().toggle()})),o().on("change",(function(){o().isFullscreen?c.classList.add("enabled"):c.classList.remove("enabled")}))):document.body.classList.add("fullscreen-disabled"),d(f[0]);const v=document.querySelector(".preloader"),_=document.querySelector("#titleBar");window.addEventListener("load",(function(){a.style.opacity=1,_.style.opacity=1,v.style.display="none"}))}()}();